import{r as n,u as D,a as H,b as U,c as M,f as $,t as R,y as i,j as e,B as P,e as A,v as J,w as O,x as V,z as W}from"./index-DMvCZNdX.js";import{L as F}from"./Layout-BpGWwOWy.js";import{T as K}from"./TabelContainer-Df-0NVOq.js";import"./Menus-C_0QUNbK.js";import"./Menus-CeiNyHsH.js";import"./index-mJC8lMn1.js";const X=({total:T,detail:t,id:E})=>{const j="",k="",C="",[b,l]=n.useState(0),[r,o]=n.useState(0),[I,p]=n.useState(0),[g,f]=n.useState(0),[u,m]=n.useState(""),[G,h]=n.useState(""),{user:c}=D(a=>a.auth),q=c==null?void 0:c.role,{data:N}=H(),{data:w={}}=U({page:j,limit:k,search:C}),{teachers:L=[]}=w,{data:v}=M(),{data:S={}}=$({page:j,limit:k,search:C,teacherId:r}),{quizes:x=[]}=S,[B,{data:s,isSuccess:d,isLoading:Q,error:y,reset:z}]=R(),_=()=>{if(!b||!r||!g||!u){i.error("Harap isi semua data!");return}B({homeId:b,teacherId:r,gradeId:g,name:u,id:E,quizId:I,time:G})};return n.useEffect(()=>{d&&(i.success(s.message),z(),l(""),o(""),f(""),m(""),p("")),y&&(i.error(y.data.message),z())},[s,d,y]),n.useEffect(()=>{t&&(l(t==null?void 0:t.homebase_id),o(t==null?void 0:t.teacher_id),m(t==null?void 0:t.schedule),h(t==null?void 0:t.time),f(t==null?void 0:t.grade_id),p(t==null?void 0:t.quiz_id))},[t]),n.useEffect(()=>{(c==null?void 0:c.role)==="teacher"&&o(c==null?void 0:c.id)},[c]),e.jsxs("div",{className:"container-fluid d-flex align-items-center justify-content-between p-2 rounded shadow bg-white",children:[e.jsxs("p",{className:"m-0 h6",children:["Jumlah Ujian: ",e.jsx("span",{children:T})]}),e.jsxs("div",{className:"d-flex gap-1",children:[e.jsx("button",{className:"btn btn-success","data-bs-toggle":"modal","data-bs-target":"#modal-add",type:"button",children:"+ Tambah"}),e.jsx("button",{className:"btn btn-danger",children:"- Hapus"})]}),e.jsx("div",{className:"modal fade",id:"modal-add","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog  modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"staticBackdropLabel",children:"Buat Ujian"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body d-flex flex-column gap-2",children:[e.jsxs("select",{name:"homeId",id:"",value:b||"",onChange:a=>l(a.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:0,hidden:!0,children:"Pilih Satuan"}),N==null?void 0:N.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),q==="admin"&&e.jsxs("select",{name:"teacherId",id:"",value:r||"",onChange:a=>o(a.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:0,hidden:!0,children:"Pilih guru"}),L.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsxs("select",{name:"quizId",id:"",value:I||"",onChange:a=>p(a.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:0,hidden:!0,children:"Pilih Bank Soal"}),x==null?void 0:x.map(a=>e.jsx("option",{value:a.id,children:a.quiz_name},a.id))]}),e.jsxs("select",{name:"gradeId",id:"",value:g||"",onChange:a=>f(a.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:0,hidden:!0,children:"Pilih Tingkat"}),v==null?void 0:v.map(a=>e.jsx("option",{value:a.id,children:a.grade},a.id))]}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Nama Ujian",value:u||"",onChange:a=>m(a.target.value)}),e.jsx("input",{type:"numeric",className:"form-control",placeholder:"Menit",value:G||"",onChange:a=>h(a.target.value)})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Batal"}),Q?e.jsx(P,{}):e.jsx("button",{type:"button",className:"btn btn-primary",onClick:_,children:"Simpan"})]})]})})})]})},Y=[{label:"No"},{label:"Nama Guru"},{label:"Nama Ujian"},{label:"Nama Bank Soal"},{label:"Tingkat"},{label:"Status"},{label:"Token"},{label:"Waktu"},{label:"Aksi"}],ce=()=>{const T=A(),[t,E]=n.useState(1),[j,k]=n.useState(10),[C,b]=n.useState(""),[l,r]=n.useState(""),{data:o={}}=J({page:t,limit:j,search:C}),{rooms:I=[],totalPages:p,totalRecords:g}=o,[f,{data:u,isSuccess:m,isLoading:G,error:h,reset:c}]=O(),{data:q}=V(l,{skip:!l}),[N,{data:w,isSuccess:L,isLoading:v,error:S,reset:x}]=W(),B=(s,d,Q)=>{const y=s.replace(/\s+/g,"-");T(`/cbt-laporan/${y}/${d}/${Q}`)};return n.useEffect(()=>{m&&(i.success(u.message),c()),h&&(i.error(h.data.message),c())},[u,m,h]),n.useEffect(()=>{L&&(i.success(w.data),x()),S&&(i.error(S.data.message),x())},[w,L,S]),e.jsx(F,{title:"Daftar Ujian",children:e.jsx("div",{className:"row",style:{height:"100%"},children:e.jsxs("div",{className:"col-12 d-flex flex-column gap-2",children:[e.jsx(X,{total:g,detail:q,id:l}),e.jsx("div",{style:{height:"calc(100vh - 150px)",overflow:"auto"},className:"rounded shadow",children:e.jsx(K,{page:t,setPage:s=>E(s),setLimit:s=>k(s),onValue:s=>b(s),totalPages:p,children:e.jsxs("table",{className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsx("tr",{children:Y.map((s,d)=>e.jsx("th",{scope:"col",className:"text-center",children:s.label},d))})}),e.jsx("tbody",{children:I.map((s,d)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"text-center align-middle",children:(t-1)*j+d+1}),e.jsx("td",{className:" align-middle",children:s.teacher}),e.jsx("td",{className:"align-middle",children:s.name}),e.jsx("td",{className:"align-middle",children:s.quiz}),e.jsx("td",{className:"text-center align-middle",children:s.grade}),e.jsx("td",{className:"text-center align-middle",children:e.jsx("div",{className:"form-check form-switch pointer d-flex justify-content-center",onClick:()=>f(s.id),children:e.jsx("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckChecked",checked:!!s.status,readOnly:!0})})}),e.jsx("td",{className:"text-center align-middle",children:s.token}),e.jsx("td",{className:"text-center align-middle",children:`${s.time} Menit`}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>B(s.quiz,s.quiz_id,s.grade_id),children:"Detail"}),e.jsx("button",{className:"btn btn-warning",type:"button","data-bs-toggle":"modal","data-bs-target":"#modal-add",onClick:()=>r(s.id),children:"Edit"}),v?e.jsx(P,{}):e.jsx("button",{className:"btn btn-danger",onClick:()=>N(s.id),children:"Hapus"})]})})]},s.id))})]})})})]})})})};export{ce as default};
