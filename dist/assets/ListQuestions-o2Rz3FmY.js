import{i as E,r as N,k as T,y as x,j as s,e as A,l as B,m as H,n as U,B as C}from"./index-DnLSs86n.js";import{L as _}from"./Layout-aapeA27G.js";import{R}from"./bundle-B65kWmIv.js";import{r as F,u as I}from"./xlsx-R0LD_mVJ.js";import"./Menus-C_0QUNbK.js";import"./Menus-CeiNyHsH.js";import"./index-Chjiymov.js";const P=()=>{const c=E(),{bankid:w}=c,[d,l]=N.useState(""),[t,{data:b,isSuccess:h,isLoading:y,error:n,reset:i}]=T(),m=o=>{l(o.target.files[0])},k=()=>{if(d){const o=new FileReader;o.onload=j=>{const v=new Uint8Array(j.target.result),u=F(v,{type:"array"}),$=u.SheetNames[0],e=u.Sheets[$],g={data:I.sheet_to_json(e,{header:1,range:1}).filter(L=>L.length>0)};t({id:w,body:g})},o.readAsArrayBuffer(d)}};return N.useEffect(()=>{h&&(x.success(b.message),l(null),i(),window.location.reload()),n&&(x.error(n.data.message),console.log(n),i())},[b,h,n]),s.jsxs("div",{children:[s.jsx("button",{className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#tambah",children:"Upload"}),s.jsx("div",{className:"modal fade",id:"tambah","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:s.jsx("div",{className:"modal-dialog modal-dialog-centered",children:s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h5",{className:"modal-title",id:"staticBackdropLabel",children:"Upload Soal"}),s.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),s.jsx("div",{className:"modal-body",children:s.jsx("input",{type:"file",className:"form-control",onChange:m})}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:()=>l(""),children:"Tutup"}),s.jsx("button",{type:"button",className:"btn btn-primary",onClick:k,children:"Upload"})]})]})})})]})},S=c=>({__html:c}),W=()=>{const c=A(),w=E(),{name:d,bankid:l}=w,{data:t}=B(l,{skip:!l}),[b,{data:h,isSuccess:y,isLoading:n,error:i,reset:m}]=H(),[k,{data:o,isSuccess:j,isLoading:v,error:u,reset:$}]=U(),e=t==null?void 0:t.filter(a=>a.type===1),r=t==null?void 0:t.filter(a=>a.type===2),D=()=>c(`/cbt-bank-soal/${d}/tambah-soal/${l}`),g=a=>c(`/cbt-bank-soal/${d}/tambah-soal/${l}/${a}`),L=()=>window.open("/temp/soal_template.xlsx","_blank"),M=()=>{window.confirm("Apakah anda yakin akan mengahpus semua pertanyaan?")&&k(l)};return N.useEffect(()=>{y&&(x.success(h.message),m(),window.location.reload()),i&&(x.error(i.data.message),m())},[h,y,i]),N.useEffect(()=>{j&&(x.success(o.message),m(),window.location.reload()),u&&(x.error(u.data.message),m())},[o,j,u]),s.jsx(_,{title:"Daftar Soal",children:s.jsxs("div",{className:"container-fluid bg-light d-flex flex-column gap-4",style:{maxHeight:"calc(100vh - 70px)",overflow:"auto"},children:[s.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-lg-between justify-content-center rounded bg-white shadow p-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"m-0 text-center text-sm-start",children:["Bank Soal : ",s.jsx("span",{children:d.replaceAll("-"," ")})]}),s.jsxs("p",{className:"m-0",children:["Komposisi: ",s.jsx("span",{children:e==null?void 0:e.length})," PG,"," ",s.jsx("span",{children:r==null?void 0:r.length})," Essay"]})]}),s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("button",{className:"btn btn-info",onClick:L,children:"Template"}),s.jsx(P,{}),s.jsx("button",{className:"btn btn-success",onClick:D,children:"Tambah"}),v?s.jsx(C,{}):s.jsx("button",{className:"btn btn-danger",onClick:M,children:"Kosongkan"})]})]}),e==null?void 0:e.map((a,p)=>s.jsxs("div",{className:"row g-1 rounded shadow p-2 border border-sm bg-white",children:[s.jsxs("div",{className:"col-lg-10 col-12 d-flex flex-column gap-1",children:[s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("p",{className:"m-0 fw-bold",children:`${p+1}.`}),s.jsx("div",{dangerouslySetInnerHTML:S(a.question)}),a.audio&&s.jsx(R,{src:a.audio,controls:!0})]}),a.choices.map((f,Q)=>f.text!==null&&s.jsxs("div",{className:"d-flex gap-2 ms-4",children:[s.jsx("p",{className:`m-0 ${f.value===a.key?"fw-bold":""}`,children:`${f.value}.`}),s.jsx("p",{className:`m-0 ${f.value===a.key?"fw-bold":""}`,dangerouslySetInnerHTML:S(f.text)})]},Q)),s.jsx("p",{className:"m-0 ms-4 text-primary fw-bold",children:`Jawaban : ${a.key}`}),s.jsx("p",{className:"m-0 ms-4 text-primary fw-bold",children:`Nilai : ${a.score}`})]}),s.jsx("div",{className:"col-lg-2 col-12",children:s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsx("button",{className:"btn btn-warning",onClick:()=>g(a.id),children:"Edit"}),n?s.jsx(C,{}):s.jsx("button",{className:"btn btn-danger",onClick:()=>b(a.id),children:"Hapus"})]})})]},p)),r==null?void 0:r.map((a,p)=>s.jsxs("div",{className:"row g-1 rounded shadow p-2 border border-sm bg-white",children:[s.jsx("div",{className:"col-lg-10 col-12",children:s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("p",{className:"m-0 fw-bold",children:`${(e==null?void 0:e.length)+p+1}.`}),s.jsx("div",{dangerouslySetInnerHTML:S(a.question)})]}),s.jsx("p",{className:"m-0 ms-4 text-primary fw-bold",children:`Nilai : ${a.score}`})]})}),s.jsx("div",{className:"col-lg-2 col-12",children:s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsx("button",{className:"btn btn-warning",onClick:()=>g(a.id),children:"Edit"}),n?s.jsx(C,{}):s.jsx("button",{className:"btn btn-danger",onClick:()=>b(a.id),children:"Hapus"})]})})]},p))]})})};export{W as default};
