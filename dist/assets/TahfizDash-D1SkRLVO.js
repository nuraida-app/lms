import{j as e,r as d,ab as K,ac as $,ad as B,ae as J,af as R,y as k,e as V,ag as H,ah as O}from"./index-BmFd-R0Z.js";import{T as U}from"./TabelContainer-CmOAOXrr.js";import"./index-DV22rdQ_.js";const W=({surahs:n,fromSurah:a,setFromSurah:h,fromAyat:i,setFromAyat:c,toAyat:p,setToAyat:b,getAyatOptions:r,handleAddToTable:x})=>e.jsxs("div",{className:"row g-2 ",children:[e.jsx("div",{className:"col-md-3 col-12",children:e.jsxs("select",{className:"form-select",value:a,onChange:s=>h(s.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Dari Surah"}),n==null?void 0:n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})}),e.jsx("div",{className:"col-md-3 col-12",children:e.jsxs("select",{className:"form-select",value:i,onChange:s=>c(s.target.value),disabled:!a,children:[e.jsx("option",{value:"",hidden:!0,children:"Dari Ayat"}),r(a).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{className:"col-md-3 col-12",children:e.jsxs("select",{className:"form-select",value:p,onChange:s=>b(s.target.value),disabled:!a,children:[e.jsx("option",{value:"",hidden:!0,children:"Sampai Ayat"}),r(a).map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{className:"col-md-3 col-12",children:e.jsx("button",{className:"btn btn-primary",disabled:!a,onClick:x,children:"Simpan"})})]}),X=({tableData:n})=>e.jsx("div",{className:"table-responsive border border-2 rounded p-1",children:e.jsxs("table",{className:"table table-striped table-hover mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Surah"}),e.jsx("th",{children:"Dari Ayat"}),e.jsx("th",{children:"Sampai Ayat"})]})}),e.jsx("tbody",{children:n.map((a,h)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.fromSurahName}),e.jsx("td",{children:a.fromAyat}),e.jsx("td",{children:a.toAyat})]},h))})]})}),Y=({categories:n})=>e.jsx("div",{className:"table-responsive border border-2 p-1 rounded",children:e.jsxs("table",{className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kategori"}),e.jsx("th",{children:"Indikator"}),e.jsx("th",{children:"Poin"})]})}),e.jsx("tbody",{children:n==null?void 0:n.map((a,h)=>e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle",children:a.category}),e.jsx("td",{className:"align-middle",children:e.jsx("div",{className:"d-flex flex-column gap-2",children:Array.isArray(a.indicators)&&a.indicators.filter(i=>i!==null).length>0?a.indicators.filter(i=>i!==null).map((i,c)=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between p-2 rounded border border-2 bg-white",children:[e.jsx("p",{className:"m-0",children:i.name}),e.jsx("input",{style:{width:200},type:"text",className:"form-control",placeholder:"Penilaian","data-indicator-id":i.id,"data-category-id":a.id})]},c)):e.jsx("p",{className:"m-0 text-muted",children:"Tidak ada indikator untuk kategori ini"})})}),e.jsx("td",{className:"align-middle",children:e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx("input",{type:"text",name:"category-score",className:"form-control",placeholder:"Nilai",style:{width:80},"data-category-id":a.id})})})]},h))})]})}),Z=({student:n})=>{const[a,h]=d.useState(""),[i,c]=d.useState(""),[p,b]=d.useState(""),[r,x]=d.useState(""),[s,j]=d.useState(""),[N,g]=d.useState(""),[u,t]=d.useState([]),{data:o}=K(),{data:A}=$(),[E,{data:I,isSuccess:P,isLoading:w,error:f,reset:L}]=B(),{data:v}=J({search:a}),{data:T}=R({search:a}),G=()=>{var l;if(r&&s&&N){const y=((l=v.find(m=>m.id===parseInt(r)))==null?void 0:l.name)||"";t(m=>[...m,{fromSurah:r,fromSurahName:y,fromAyat:s,toAyat:N}]),x(""),j(""),g("")}},_=l=>{const y=v==null?void 0:v.find(m=>m.id===parseInt(l));return y?Array.from({length:y.ayat},(m,C)=>C+1):[]},z=()=>{const l=document.querySelectorAll("[name='category-score']"),y=document.querySelectorAll("input[data-indicator-id]"),m=Array.from(l).map(D=>{const Q=D.dataset.categoryId,q=D.value,F=Array.from(y).filter(S=>S.dataset.categoryId===Q).map(S=>({indicator_id:parseInt(S.dataset.indicatorId),poin:S.value}));return{category_id:parseInt(Q),poin:q,indicators:F}}),C={nis:n.nis,surahs:u,examiner:p,poin:{type_id:parseInt(i),categories:m}};if(!i||!p||!u||!m)return k.warning("Lengkapi data");E(C)},M=()=>{c(""),b(""),x(""),j(""),g(""),t([])};return d.useEffect(()=>{P&&(k.success(I.message),c(""),b(""),x(""),j(""),g(""),t([]),L()),f&&(console.log(f),k.error(f.data.message),L())},[I,P,f]),e.jsx("div",{className:"modal fade",id:"nilai",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"exampleModalLabel",children:n==null?void 0:n.name}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body d-flex flex-column gap-2",children:[e.jsxs("div",{className:"d-flex justify-content-between gap-2",children:[e.jsxs("select",{name:"type",id:"1",className:"form-select",value:i||"",onChange:l=>c(l.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Pilih Jenis Penilaian"}),o==null?void 0:o.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),e.jsxs("select",{name:"type",id:"1",className:"form-select",value:p||"",onChange:l=>b(l.target.value),children:[e.jsx("option",{value:"",hidden:!0,children:"Pilih Penguji"}),T==null?void 0:T.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsx(W,{surahs:v,fromSurah:r,setFromSurah:x,fromAyat:s,setFromAyat:j,toAyat:N,setToAyat:g,getAyatOptions:_,handleAddToTable:G}),e.jsx(X,{tableData:u}),(u==null?void 0:u.length)>0&&e.jsx(Y,{categories:A})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",onClick:M,children:"Batal"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:z,disabled:!!w,children:w?"Loading...":"Simpan"})]})]})})})},ee=[{label:"No"},{label:"NIS"},{label:"Nama Lengkap"},{label:"Tingkat"},{label:"Kelas"},{label:"Aksi"}],le=()=>{const n=V(),[a,h]=d.useState(1),[i,c]=d.useState(10),[p,b]=d.useState(""),[r,x]=d.useState({}),{data:s={}}=H({page:a,limit:i,search:p}),{students:j=[],totalPages:N,totalData:g}=s,u=(t,o)=>{const A=o.replace(/\s+/g,"-");n(`/tahfiz-laporan-siswa/${t}/${A}`)};return e.jsx(O,{title:"Administrator Tahfiz",children:e.jsxs("div",{style:{height:"calc(100vh - 70px)",overflow:"auto"},children:[e.jsxs(U,{page:a,setPage:t=>h(t),setLimit:t=>c(t),onValue:t=>b(t),totalPages:N,children:[e.jsxs("p",{className:"m-0 h6 mx-2",children:["Total Siswa ",e.jsx("span",{children:g})]}),e.jsxs("table",{className:"table table-striped table-hover",children:[e.jsx("thead",{children:e.jsx("tr",{children:ee.map((t,o)=>e.jsx("th",{scope:"col",className:"text-center",children:t.label},o))})}),e.jsx("tbody",{children:j==null?void 0:j.map((t,o)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",className:"text-center align-middle",children:(a-1)*i+o+1}),e.jsx("td",{className:"align-middle text-center",children:t.nis}),e.jsx("td",{className:"align-middle",children:t.name}),e.jsx("td",{className:"text-center align-middle",children:t.grade}),e.jsx("td",{className:"text-center align-middle",children:t.class}),e.jsx("td",{className:"text-center align-middle",children:e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#nilai",onClick:()=>x(t),children:"Nilai"}),e.jsx("button",{className:"btn btn-info",onClick:()=>u(t.nis,t.name),children:"Laporan"})]})})]},t.id))})]})]}),e.jsx(Z,{student:r})]})})};export{le as default};
