import{u as T,a as D,b as H,c as $,d as A,r as n,y as N,j as e,B as L,e as M,f as R,g as V,h as Y}from"./index-SXBgl-Na.js";import{L as F}from"./Layout-8mQfpZ_3.js";import{T as J}from"./TabelContainer-YSWDuOy7.js";import"./Menus-C_0QUNbK.js";import"./Menus-CeiNyHsH.js";import"./index-CzZiVV_3.js";const K=({detail:t,id:d})=>{const v="",g="",S="",{user:c}=T(s=>s.auth),y=c==null?void 0:c.role,{data:r}=D(),{data:k={}}=H({page:v,limit:g,search:S}),{teachers:w=[]}=k,{data:u}=$(),[B,{data:C,isSuccess:p,isLoading:z,error:o,reset:m}]=A(),[j,i]=n.useState(""),[h,x]=n.useState(""),[b,a]=n.useState(""),[l,f]=n.useState(""),[Q,E]=n.useState(""),[G,q]=n.useState(""),[I,_]=n.useState(""),P=s=>{s.preventDefault(),B({id:d,homeId:j,teacherId:h,gradeId:b,shuffle:l,quizName:Q,mc:G,essay:I})};return n.useEffect(()=>{p&&(N.success(C.message),m(),window.location.reload()),o&&(N.error(o.data.message),m())},[C,p,o]),n.useEffect(()=>{t&&(i(t==null?void 0:t.homebase_id),x(t==null?void 0:t.teacher_id),a(t==null?void 0:t.grade_id),f(t==null?void 0:t.shuffle),q(t==null?void 0:t.mc_weight),_(t==null?void 0:t.essay_weight),E(t==null?void 0:t.quiz_name))},[t]),n.useEffect(()=>{(c==null?void 0:c.role)==="teacher"&&x(c.id)},[c]),e.jsxs("div",{className:"rounded shadow d-flex flex-column gap-2 mt-2 p-2 bg-white border border-2",children:[e.jsx("p",{className:"h5 m-0",children:"Buat Bank Soal Baru"}),e.jsxs("form",{action:"",className:"d-flex flex-column gap-2",onSubmit:P,children:[e.jsxs("select",{name:"homeId",id:"",value:j,onChange:s=>i(s.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Pilih Satuan"}),r==null?void 0:r.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),y==="admin"&&e.jsxs("select",{name:"teacherId",id:"",value:h,onChange:s=>x(s.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Pilih guru"}),w.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{name:"gradeId",id:"",value:b,onChange:s=>a(s.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:0,children:"Pilih Tingkat"}),u==null?void 0:u.map(s=>e.jsx("option",{value:s.id,children:s.grade},s.id))]}),e.jsxs("select",{name:"shuffle",id:"",value:l,onChange:s=>f(s.target.value),className:"form-control",required:!0,children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Acak Soal"}),e.jsx("option",{value:!0,children:"Ya"}),e.jsx("option",{value:!1,children:"Tidak"})]}),e.jsx("input",{type:"text",name:"",id:"",className:"form-control",placeholder:"Nama Bank Soal",required:!0,value:Q,onChange:s=>E(s.target.value)}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:"Bobot PG"}),e.jsx("input",{type:"number",className:"form-control",placeholder:"60",value:G,onChange:s=>q(s.target.value)})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:"Bobot Essay"}),e.jsx("input",{type:"number",className:"form-control",placeholder:"40",value:I,onChange:s=>_(s.target.value)})]}),z?e.jsx(L,{}):e.jsx("button",{type:"submit",className:"btn btn-success",children:"+ Tambahkan"})]})]})},O=[{label:"No"},{label:"Nama Guru"},{label:"Nama Bank Soal"},{label:"Tingkat"},{label:"PG"},{label:"Bobot PG"},{label:"Essay"},{label:"Bobot Essay"},{label:"Aksi"}],te=()=>{const t=M(),[d,v]=n.useState(1),[g,S]=n.useState(10),[c,y]=n.useState(""),[r,k]=n.useState(""),{data:w={}}=R({page:d,limit:g,search:c}),{quizes:u=[],totalPages:B,total:C}=w,{data:p}=V(r,{skip:!r}),[z,{data:o,isSuccess:m,isLoading:j,error:i,reset:h}]=Y(),x=a=>z(a),b=(a,l)=>{const f=a.replace(/\s+/g,"-");t(`/cbt-bank-soal/${f}/${l}`)};return n.useEffect(()=>{m&&(N.success(o.message),h()),i&&(N.error(i.data.message),h())},[o,m,i]),e.jsx(F,{title:"Bank Soal",children:e.jsxs("div",{className:"row",style:{height:"100%"},children:[e.jsx("div",{className:"col-lg-3 col-12",children:e.jsx(K,{detail:p,id:r})}),e.jsx("div",{className:"col-lg-9 cool-12",style:{maxHeight:"calc(100vh - 70px)",overflow:"auto"},children:e.jsx(J,{page:d,setPage:a=>v(a),setLimit:a=>S(a),onValue:a=>y(a),totalPages:B,children:e.jsxs("table",{className:"table table-striped table-hover mt-2",children:[e.jsx("thead",{children:e.jsx("tr",{children:O.map((a,l)=>e.jsx("th",{scope:"col",className:"align-middle text-center",children:a.label},l))})}),e.jsx("tbody",{children:u.map((a,l)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",className:"align-middle text-center",children:(d-1)*g+l+1}),e.jsx("td",{className:"align-middle",children:a.teacher}),e.jsx("td",{className:"align-middle",children:a.quiz_name}),e.jsx("td",{className:"align-middle text-center",children:a.grade}),e.jsx("td",{className:"align-middle text-center",children:a.mc}),e.jsx("td",{className:"align-middle text-center",children:`${a.mc_weight} %`}),e.jsx("td",{className:"align-middle text-center",children:a.essay}),e.jsx("td",{className:"align-middle text-center",children:`${a.essay_weight} %`}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-success",onClick:()=>b(a.quiz_name,a.id),children:"Soal"}),e.jsx("button",{className:"btn btn-warning",onClick:()=>k(a.id),children:"Edit"}),j?e.jsx(L,{}):e.jsx("button",{className:"btn btn-danger",onClick:()=>x(a.id),children:"Hapus"})]})})]},a.id))})]})})})]})})};export{te as default};
