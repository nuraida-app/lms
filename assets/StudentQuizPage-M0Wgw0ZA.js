import{a as G,an as Y,r as s,B as n,j as r,c as h,C as d,b as R,am as K,ao as O}from"./index-CSxfCMfO.js";import{L as W}from"./Layout-BlhhzcWV.js";import{P as J}from"./PageName-EximxSIq.js";/* empty css               */import{C as U,a as V,b as X}from"./CardContent-D4Ouh6_B.js";import{T as l}from"./Typography-CvABrH6u.js";import{M as Z,F as ee}from"./Modal-BxMNLGUj.js";import{I as F}from"./Input-BytLO2YT.js";import{B as re}from"./Button-C8egMFNd.js";import{P as se}from"./Paper-1BeYRGVZ.js";import"./FolderCopy-B9muDkxL.js";import"./getThemeProps-Bm4LwIY-.js";import"./createSvgIcon-CUdXFR2t.js";import"./GlobalStyles-BxWeaP1-.js";import"./listItemIconClasses-DH5o3P_F.js";import"./useTheme-CrWoQ2Gw.js";import"./ChevronRight-BDbCwA2d.js";import"./ExitToApp-BfJL4ORI.js";import"./Toolbar-0QhF5KIa.js";import"./IconButton-BKERT6y0.js";import"./utils-DhE5sAzO.js";const C=e=>{try{const o=new Date(e);return new Intl.DateTimeFormat("en-EN",{weekday:"short",day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric"}).format(o)}catch{return console.error("Invalid date string:",e),"Invalid date"}},oe=({data:e,user:o,log:t})=>{const c=G(),[f,{data:a,isLoading:b,isSuccess:j,error:p,reset:g}]=Y(),[S,z]=s.useState(!1),[k,Q]=s.useState(!1),[w,y]=s.useState(""),[T,I]=s.useState(!1),[D,q]=s.useState(""),[v,E]=s.useState(""),[L,N]=s.useState(""),[m,P]=s.useState(""),A=(i,u,x,H,M,$)=>{z(!0),Q(i),I(u),q(x),E(H),N(M),P($)},B=i=>{if(i.preventDefault(),w!==k)return n.error("Token is mismatch");if(!T)return n.error("Quiz is inactive");const u=new Date;if(u<new Date(D))return n.error("Quiz have not started yet");if(u>new Date(v))return n.error("Quiz is finished");if(t&&t.isDone&&t.quiz_id===m)return n.error("You have already joined this exam");if(t&&t.isActive&&t.quiz_id===m)return n.error("You are joining this exam");const x={quizId:m,nis:o.nis};f(x)},_=()=>{z(!1),y("")};return s.useEffect(()=>{if(j){n.success(a.message);const i=L.replace(/\s+/g,"-");c(`/student/exam/${i}/${m}/${D}/${v}`),g(),localStorage.removeItem("questions")}p&&(n.error(p.data.message),g())},[j,a,p]),r.jsxs(s.Fragment,{children:[r.jsx(U,{sx:{width:260,bgcolor:new Date(e==null?void 0:e.start)>new Date?"#015AFF":new Date(e==null?void 0:e.end)<new Date?"#FF1414":"#37FF21",color:new Date(e==null?void 0:e.start)>new Date?"#F7F7F7":new Date(e==null?void 0:e.end)<new Date?"#0C0C0C":"#000000"},children:r.jsx(V,{onClick:()=>A(e==null?void 0:e.token,e==null?void 0:e.status,e==null?void 0:e.start,e==null?void 0:e.end,e==null?void 0:e.quiz,e==null?void 0:e.quiz_id),children:r.jsxs(X,{children:[r.jsx(l,{fontSize:16,children:e==null?void 0:e.quiz}),r.jsx(l,{fontSize:12,fontStyle:"italic",children:e==null?void 0:e.teacher}),r.jsxs(l,{fontSize:12,sx:{mt:1},children:["Start: ",C(e==null?void 0:e.start)]}),r.jsxs(l,{fontSize:12,children:["End: ",C(e==null?void 0:e.end)]})]})})}),r.jsx(Z,{open:S,onClose:_,closeAfterTransition:!0,children:r.jsx(ee,{in:S,children:r.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:r.jsxs("form",{onSubmit:B,className:"form-confirm",children:[r.jsx(F,{placeholder:"TOKEN",value:w,onChange:i=>y(i.target.value)}),r.jsx(re,{type:"submit",variant:"contained",color:"error",children:b?r.jsx(d,{size:20,color:"inherit"}):"submit"})]})})})})]})},Fe=()=>{const{user:e}=R(c=>c.authentication),{data:o}=K(e==null?void 0:e.grade_id,{skip:!(e!=null&&e.grade_id)}),{data:t}=O(e==null?void 0:e.nis,{skip:!(e!=null&&e.nis)});return r.jsxs(W,{children:[r.jsx(J,{title:"Quiz"}),r.jsxs(h,{sx:{height:"82vh",display:"flex",flexDirection:"column",gap:1},children:[r.jsx(se,{sx:{p:1},children:r.jsx(F,{placeholder:"Search Exam"})}),r.jsx(h,{sx:{display:"flex",flexWrap:"wrap",gap:1,maxHeight:520,overflow:"auto",alignItems:"start",overflowY:"auto"},children:o==null?void 0:o.map((c,f)=>r.jsx(oe,{data:c,user:e,log:t},f))})]})]})};export{Fe as default};
