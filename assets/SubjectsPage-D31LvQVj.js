import{o as G,r as a,B as S,j as e,c as p,C as k,p as $,q,s as O,t as Q,v as X,h as J}from"./index-DrjOkbMF.js";import{L as K}from"./Layout-DvDTLufS.js";import{P as V}from"./PageName-xgZkBGa5.js";import{d as Y}from"./MoreHoriz-B4X9A2zO.js";import{d as Z,a as ee}from"./FolderDelete-pp-Veulz.js";import{d as te,a as se}from"./InsertDriveFileOutlined-CvkuaFAf.js";import"./iziToast-B8Ncus04.js";import{M as T,F as E}from"./Modal-DnpYw_5G.js";import{T as w}from"./TextField-D-EmQiuj.js";import{B as m}from"./Button-B9x14mlL.js";import{r as re,u as oe}from"./xlsx-DT8pmw08.js";import{I as R}from"./Input-CJ_IMTS2.js";import{T as ae}from"./Typography-CtklAiV2.js";import{S as W}from"./Style-D_zL675F.js";import{P as ne}from"./Paper-Bp5qieF9.js";import{T as ie}from"./TableContainer-BnT_tnIL.js";import{T as le,a as ce,b as _,c as y,d as de}from"./TableRow-CCmgggxF.js";import{I as ue}from"./IconButton-DgCIXltQ.js";import{M as xe}from"./Menu-CBFRUQd4.js";import{M as B}from"./MenuItem-DGjjTywL.js";import{G as H}from"./Grid-CTmK_NJm.js";import{S as fe}from"./Stack-c_kRUfZq.js";import"./FolderCopy-BDNtKHtb.js";import"./getThemeProps-CBpHDveP.js";import"./createSvgIcon-D54I0b-a.js";import"./GlobalStyles-L42X9mfA.js";import"./listItemIconClasses-DsC-WpG4.js";import"./useTheme-Ck14E_Eb.js";import"./ChevronRight-DXHKMLLm.js";import"./PeopleAlt-CfqqMHhK.js";import"./CalendarMonth-OHCsWFnV.js";import"./ExitToApp-BYaKrXcn.js";import"./Toolbar-B6cF_c_O.js";import"./FormControl-BOKQ-VL3.js";import"./utils-DO7AQVW6.js";import"./Select-CpyyjA0G.js";import"./Grow-ByVg5b5M.js";import"./useThemeProps-GE6ZKEHT.js";const me=({open:o,close:t})=>{const[s,{data:n,isLoading:l,isSuccess:r,error:i,reset:c}]=G(),[d,h]=a.useState(""),[g,b]=a.useState(""),j=x=>{x.preventDefault(),s({code:d,subject:g})};return a.useEffect(()=>{r&&(S.success(n.message),h(""),b(""),t(),c()),i&&(S.error(i.data.message),c())},[r,i,n]),e.jsx(T,{open:o,onClose:t,children:e.jsx(E,{in:o,children:e.jsx(p,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:l?e.jsx(k,{}):e.jsxs("form",{className:"form-subject",onSubmit:j,children:[e.jsx(w,{fullWidth:!0,label:"Code",placeholder:"Code",value:d,onChange:x=>h(x.target.value)}),e.jsx(w,{fullWidth:!0,label:"Subject",placeholder:"Subject",value:g,onChange:x=>b(x.target.value)}),e.jsxs(p,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(m,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"contained",color:"success",type:"submit",children:"add"})]})]})})})})},he=({open:o,close:t})=>{const[s,{data:n,isSuccess:l,error:r,reset:i,isLoading:c}]=$(),[d,h]=a.useState(null),g=j=>{h(j.target.files[0])},b=()=>{if(d){const j=new FileReader;j.onload=x=>{const f=new Uint8Array(x.target.result),C=re(f,{type:"array"}),L=C.SheetNames[0],M=C.Sheets[L],A={data:oe.sheet_to_json(M,{header:1,range:1})};s(A)},j.readAsArrayBuffer(d)}};return a.useEffect(()=>{l&&(S.success(n.message),h(null),i(),t()),r&&S.error(r.data.messege)},[n,l,r]),e.jsx(T,{open:o,onClose:t,closeAfterTransition:!0,children:e.jsx(E,{in:o,children:e.jsx(p,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs(p,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(R,{required:!0,fullWidth:!0,type:"file",placeholder:"Upload file here",onChange:g}),e.jsxs(p,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:1},children:[e.jsx(m,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"contained",color:"success",onClick:b,children:c?e.jsx(k,{size:18,color:"inherit"}):"update"})]})]})})})})},je=({open:o,close:t})=>{const[s,{data:n,isLoading:l,isSuccess:r,error:i,reset:c}]=q(),d=()=>s();return a.useEffect(()=>{r&&(S.success(n.message),t(),c()),i&&(S.error(i.data.message),c())},[r,n,i]),e.jsx(T,{open:o,onClose:t,closeAfterTransition:!0,children:e.jsx(E,{in:o,children:e.jsxs(p,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:[e.jsx(ae,{align:"center",children:"Are you sure you want to delete all subjects?"}),e.jsxs(p,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:2},children:[e.jsx(m,{variant:"contained",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"outlined",color:"error",onClick:d,children:l?e.jsx(k,{size:15}):"sure"})]})]})})})},pe=()=>{const[o,t]=a.useState(!1),[s,n]=a.useState(!1),[l,r]=a.useState(!1),i=()=>{open("/mapel_template.xlsx","_blank")};return e.jsxs(p,{sx:{display:"flex",justifyContent:{xs:"start",md:"end"},gap:1,flexWrap:"wrap"},children:[e.jsx(m,{variant:"contained",color:"success",startIcon:e.jsx(Z,{}),onClick:()=>n(!0),sx:{width:120},children:"add"}),e.jsx(m,{startIcon:e.jsx(te,{}),variant:"contained",color:"secondary",onClick:()=>r(!0),sx:{width:120},children:"Upload"}),e.jsx(m,{startIcon:e.jsx(se,{}),variant:"contained",color:"warning",onClick:i,sx:{width:120},children:"Template"}),e.jsx(m,{startIcon:e.jsx(ee,{}),variant:"contained",color:"error",onClick:()=>t(!0),sx:{width:120},children:"Delete"}),e.jsx(me,{open:s,close:()=>n(!1)}),e.jsx(he,{open:l,close:()=>r(!1)}),e.jsx(je,{open:o,close:()=>t(!1)})]})},be=({open:o,close:t,data:s,loading:n})=>{const[l,{data:r,isSuccess:i,isLoading:c,error:d}]=O(),[h,g]=a.useState(""),[b,j]=a.useState(""),x=f=>{f.preventDefault();const C={code:h,subject:b};l({id:s==null?void 0:s.id,body:C})};return a.useEffect(()=>{s&&(g(s==null?void 0:s.code),j(s==null?void 0:s.name))},[s]),a.useEffect(()=>{i&&S.success(r==null?void 0:r.message),d&&S.error(d.data.message)},[i,d,r]),e.jsx(T,{open:o,onClose:t,children:e.jsx(E,{in:o,children:e.jsx(p,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:n||c?e.jsx(W,{variant:"rounded",width:210,height:60}):e.jsxs("form",{className:"form-subject",onSubmit:x,children:[e.jsx(w,{fullWidth:!0,label:"Code",placeholder:"Code",value:h||"",onChange:f=>g(f.target.value)}),e.jsx(w,{fullWidth:!0,label:"Subject",placeholder:"Subject",value:b||"",onChange:f=>j(f.target.value)}),e.jsxs(p,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:2},children:[e.jsx(m,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"contained",color:"success",type:"submit",children:"add"})]})]})})})})},Se=[{label:"No",minWidth:30},{label:"Code",minWidth:50},{label:"Homebase",minWidth:50},{label:"Name",minWidth:100},{label:"Actions",minWidth:50}],ge=({subjects:o})=>{const[t,s]=a.useState(null),[n,l]=a.useState(null),r=!!t,i=(u,v)=>{s(u.currentTarget),l(v)},c=()=>{s(null),l(null)},[d,h]=a.useState(!1),[g,{data:b,isLoading:j,isSuccess:x,error:f}]=Q(),[C,{data:L,isLoading:M}]=X(),I=()=>{n&&(g(n),c())},A=()=>{n&&(C(n),h(!0),c())};a.useEffect(()=>{x&&S.success(b.message),f&&S.error(f.data.message)},[x,b,f]);const[F,N]=a.useState(""),P=u=>u.name.toLowerCase().includes(F.toLowerCase()),D=o==null?void 0:o.filter(P),U=u=>{N(u.target.value)};return e.jsxs(a.Fragment,{children:[e.jsxs(p,{sx:{p:1,mb:1,boxShadow:2,bgcolor:"white",borderRadius:1,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column-reverse",md:"row"},gap:2},children:[e.jsx(R,{placeholder:"Search Subject",value:F,onChange:U}),e.jsx(pe,{})]}),e.jsx(ne,{sx:{width:"100%",overflowX:"auto"},children:e.jsx(ie,{sx:{height:{xs:500,md:532,xl:630},overflow:"auto"},children:e.jsxs(le,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(ce,{children:e.jsx(_,{children:Se.map((u,v)=>e.jsx(y,{align:"center",sx:{width:u.minWidth},children:u.label},v))})}),e.jsx(de,{children:D==null?void 0:D.map((u,v)=>e.jsxs(_,{children:[e.jsx(y,{align:"center",children:v+1}),e.jsx(y,{align:"center",children:u.code}),e.jsx(y,{align:"center",children:u.homebase}),e.jsx(y,{align:"left",children:u.name}),e.jsx(y,{align:"center",children:e.jsx(ue,{id:"basic-button","aria-controls":r?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":r?"true":void 0,onClick:z=>i(z,u.id),children:j?e.jsx(k,{size:24}):e.jsx(Y,{})})})]},v))})]})})}),e.jsxs(xe,{id:"basic-menu",anchorEl:t,open:r,onClose:c,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(B,{onClick:A,children:"Edit"}),e.jsx(B,{onClick:I,children:"Delete"})]}),e.jsx(be,{open:d,close:()=>h(!1),data:L,loading:M})]})},at=()=>{const{data:o,isLoading:t}=J();return e.jsxs(K,{children:[e.jsx(V,{title:"Subjects"}),e.jsx(H,{container:!0,sx:{minHeight:"84vh",display:"flex",flexDirection:"column"},children:e.jsx(H,{item:!0,xs:12,md:12,children:t?e.jsxs(fe,{spacing:1,children:[e.jsx(W,{variant:"text",sx:{fontSize:"2rem"}}),e.jsx(W,{variant:"rounded",sx:{height:{xs:500,md:540,xl:640}}})]}):e.jsx(ge,{subjects:o})})})]})};export{at as default};
