import{R as z,r as a,B as b,j as e,c as h,C,bH as $,bI as G,bJ as q,bK as J,T as K,bL as O}from"./index-DseGlEn2.js";import{L as Q}from"./Layout-CC5z1PQd.js";import{d as V}from"./MoreHoriz-DvgxSvwb.js";import{M as I,B,F as N}from"./Modal-CZpqic7p.js";import{T}from"./TextField-gcf5tuDd.js";import{B as f}from"./Button-D3dtf5I2.js";import{d as X,a as Y}from"./FolderDelete-oHO5oc3o.js";import{d as Z,a as ee}from"./InsertDriveFileOutlined-ByojGbde.js";import"./iziToast-qEAS-YUZ.js";import{r as te,u as se}from"./xlsx-DT8pmw08.js";import{I as R}from"./Input-mgiYIdzc.js";import{T as ae}from"./Typography-D62_FcaR.js";import{T as re}from"./TableContainer-6Ps-OcDV.js";import{T as oe,a as D,b as v,c as ne}from"./TableRow-BRGkq3az.js";import{T as le}from"./TableHead-C_-qEoL7.js";import{I as ie}from"./IconButton-DGgt21TI.js";import{M as de}from"./Menu-CvZMAvku.js";import{M as L}from"./MenuItem-CDZnE07x.js";import{P as ce}from"./Paper-Do8G_qcW.js";import"./createSvgIcon-DE2C_iXj.js";import"./PeopleAlt-CnSvGnYc.js";import"./ExitToApp-Dn-2eoyy.js";import"./Grid-B5eORLoI.js";import"./useTheme-fiHJaPup.js";import"./FormControl-CjZUC6Lr.js";import"./utils-Czgi5rYC.js";import"./Select-DVN36p8b.js";import"./GlobalStyles-CqLW78_n.js";import"./listItemIconClasses-CXXb0U3Z.js";import"./Grow-BE9qEfyU.js";const ue=({open:s,close:t,student:i})=>{const[n,{data:d,isSuccess:l,isLoading:o,error:u}]=z(),[p,m]=a.useState(""),[j,x]=a.useState(""),g=r=>{r.preventDefault();const S={nis:p,name:j};n({id:i.id,body:S})};return a.useEffect(()=>{l&&(b.success(d.message),t()),u&&b.error(u.data.message)},[l,d,u]),a.useEffect(()=>{i&&(m(i.nis),x(i.name))},[i]),e.jsx(I,{open:s,onClose:t,closeAfterTransition:!0,slots:{backdrop:B},slotProps:{backdrop:{timeout:500}},children:e.jsx(N,{in:s,children:e.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-class",onSubmit:g,children:[e.jsx(T,{fullWidth:!0,label:"NIS",placeholder:"NIS",value:p||"",onChange:r=>m(r.target.value)}),e.jsx(T,{fullWidth:!0,label:"Full name",placeholder:"Full name",value:j||"",onChange:r=>x(r.target.value)}),e.jsxs(h,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",color:"error",onClick:t,children:"batal"}),e.jsx(f,{variant:"contained",color:"success",type:"submit",children:o?e.jsx(C,{size:20,color:"inherit"}):"update"})]})]})})})})},xe=({open:s,close:t})=>{const[i,{data:n,isSuccess:d,isLoading:l,error:o,reset:u}]=$(),[p,m]=a.useState(""),[j,x]=a.useState(""),g=r=>{r.preventDefault(),i({nis:p,name:j})};return a.useEffect(()=>{d&&(b.success(n.message),m(""),x(""),t(),u()),o&&b.error(o.data.message)},[d,n,o]),e.jsx(I,{open:s,onClose:t,closeAfterTransition:!0,slots:{backdrop:B},slotProps:{backdrop:{timeout:500}},children:e.jsx(N,{in:s,children:e.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-class",onSubmit:g,children:[e.jsx(T,{fullWidth:!0,label:"NIS",placeholder:"NIS",value:p,onChange:r=>m(r.target.value)}),e.jsx(T,{fullWidth:!0,label:"Full name",placeholder:"Full name",value:j,onChange:r=>x(r.target.value)}),e.jsxs(h,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",color:"error",onClick:t,children:"batal"}),e.jsx(f,{variant:"contained",color:"success",type:"submit",children:l?e.jsx(C,{size:20,color:"inherit"}):"add"})]})]})})})})},fe=({open:s,close:t})=>{const[i,{data:n,isSuccess:d,error:l,isLoading:o}]=G(),[u,p]=a.useState(null),m=x=>{p(x.target.files[0])},j=()=>{if(u){const x=new FileReader;x.onload=g=>{const r=new Uint8Array(g.target.result),S=te(r,{type:"array"}),y=S.SheetNames[0],A=S.Sheets[y],E={data:se.sheet_to_json(A,{header:1,range:1})};i(E)},x.readAsArrayBuffer(u)}};return a.useEffect(()=>{d&&(b.success(n.message),p(null),t()),l&&b.error(l.data.message)},[d,n,l]),e.jsx(I,{open:s,onClose:t,closeAfterTransition:!0,children:e.jsx(N,{in:s,children:e.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs(h,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(R,{required:!0,fullWidth:!0,type:"file",placeholder:"Upload file here",onChange:m}),e.jsxs(h,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:1},children:[e.jsx(f,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(f,{variant:"contained",color:"success",onClick:j,children:o?e.jsx(C,{size:20,color:"inherit"}):"upload"})]})]})})})})},he=({open:s,close:t})=>{const[i,{data:n,isSuccess:d,isLoading:l,error:o}]=q(),u=()=>i();return a.useEffect(()=>{d&&(b.success(n.message),t()),o&&b.error(o.data.message)},[d,n,o]),e.jsx(I,{open:s,onClose:t,closeAfterTransition:!0,children:e.jsx(N,{in:s,children:e.jsxs(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:[e.jsx(ae,{align:"center",children:"Are you sure you want to delete all students?"}),e.jsxs(h,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:2},children:[e.jsx(f,{variant:"contained",color:"error",onClick:t,children:"cancel"}),e.jsx(f,{variant:"outlined",color:"error",onClick:u,children:l?e.jsx(C,{size:20,color:"inherit"}):"sure"})]})]})})})},pe=()=>{const[s,t]=a.useState(!1),[i,n]=a.useState(!1),[d,l]=a.useState(!1),o=()=>{open("/siswa_template.xlsx","_blank")};return e.jsxs(h,{sx:{display:"flex",justifyContent:{xs:"start",md:"end"},gap:1,flexWrap:"wrap"},children:[e.jsx(f,{variant:"contained",color:"success",startIcon:e.jsx(X,{}),onClick:()=>n(!0),sx:{width:120},children:"add"}),e.jsx(f,{startIcon:e.jsx(Z,{}),variant:"contained",color:"secondary",onClick:()=>l(!0),sx:{width:120},children:"Upload"}),e.jsx(f,{startIcon:e.jsx(ee,{}),variant:"contained",color:"warning",sx:{width:120},onClick:o,children:"Template"}),e.jsx(f,{startIcon:e.jsx(Y,{}),variant:"contained",color:"error",onClick:()=>t(!0),sx:{width:120},children:"Delete"}),e.jsx(xe,{open:i,close:()=>n(!1)}),e.jsx(fe,{open:d,close:()=>l(!1)}),e.jsx(he,{open:s,close:()=>t(!1)})]})},me=[{label:"No",width:40},{label:"NIS",width:100},{label:"Nama",width:170},{label:"Aksi",width:100}],je=({students:s,loading:t})=>{const[i,{data:n,isLoading:d,isSuccess:l,error:o}]=J(),[u,{data:p}]=K(),[m,j]=a.useState(null),[x,g]=a.useState(!1),[r,S]=a.useState(""),y=!!m,A=(c,w)=>{j(c.currentTarget),S(w)},k=()=>{j(null)},E=()=>{r&&(k(),i(r))},_=()=>{r&&(g(!0),u(r),k())};a.useEffect(()=>{l&&b.success(n.message),o&&b.error(o.data.message)},[n,l,o]);const[M,H]=a.useState(""),P=c=>c.name.toLowerCase().includes(M.toLowerCase()),F=s==null?void 0:s.filter(P),U=c=>{H(c.target.value)};return e.jsxs(a.Fragment,{children:[e.jsxs(h,{sx:{p:1,boxShadow:2,bgcolor:"white",borderRadius:1,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column-reverse",md:"row"},gap:1},children:[e.jsx(R,{placeholder:"Search student",value:M,onChange:U}),e.jsx(pe,{})]}),t?e.jsx(h,{sx:{height:"85vh",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(C,{})}):e.jsx(re,{sx:{height:{xs:500,md:530,lg:630,xl:780},overflow:"auto"},children:e.jsxs(oe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(le,{children:e.jsx(D,{children:me.map((c,w)=>e.jsx(v,{align:"center",sx:{width:c.width},children:c.label},w))})}),e.jsx(ne,{children:F==null?void 0:F.map((c,w)=>e.jsxs(D,{children:[e.jsx(v,{align:"center",children:w+1}),e.jsx(v,{align:"center",children:c.nis}),e.jsx(v,{align:"left",children:c.name}),e.jsx(v,{align:"center",children:e.jsx(ie,{color:"primary",id:"basic-button","aria-controls":y?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":y?"true":void 0,onClick:W=>A(W,c.id),children:d?e.jsx(C,{size:20,color:"inherit"}):e.jsx(V,{})})})]},c.id))})]})}),e.jsxs(de,{id:"basic-menu",anchorEl:m,open:y,onClose:k,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(L,{onClick:_,children:"Edit"}),e.jsx(L,{onClick:E,children:"Delete"})]}),e.jsx(ue,{open:x,close:()=>g(!1),student:p})]})},Oe=()=>{const{data:s,isLoading:t}=O();return e.jsx(Q,{children:e.jsx(ce,{sx:{p:1},children:e.jsx(je,{students:s,loading:t})})})};export{Oe as default};
