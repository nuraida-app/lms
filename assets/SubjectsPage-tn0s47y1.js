import{o as G,r as a,B as g,j as e,c as j,C as k,p as $,q,s as K,t as O,v as Q,h as X}from"./index-CYXdUE1E.js";import{L as J}from"./Layout-D1sRhZwS.js";import{P as V}from"./PageName-CxDLnQFs.js";import{d as Y}from"./MoreHoriz-NAqvCWHV.js";import{d as Z,a as ee}from"./FolderDelete-5QYzuEeM.js";import{d as te,a as se}from"./InsertDriveFileOutlined-DB-vpx9q.js";import"./iziToast-lJ1Coa1B.js";import{M as T,F as M}from"./Modal-Crt72BC3.js";import{T as w}from"./TextField-DAoeAYbq.js";import{B as m}from"./Button-BStGdRtB.js";import{r as re,u as oe}from"./xlsx-DT8pmw08.js";import{I as R}from"./Input-DTyQuvE5.js";import{T as ae}from"./Typography-BE36mMcC.js";import{S as I}from"./Style-Dt-mDLA7.js";import{P as ne}from"./Paper-AuHIivCD.js";import{T as ie}from"./TableContainer-COIuo7oA.js";import{T as le,a as H,b as y,c as ce}from"./TableRow-gTMiIF1c.js";import{T as de}from"./TableHead-1WtMxtLe.js";import{I as ue}from"./IconButton-Bi62Yzjz.js";import{M as xe}from"./Menu-iVf4hf8j.js";import{M as _}from"./MenuItem-BD_El1ju.js";import{G as B}from"./Grid-Dulq5jJu.js";import{S as fe}from"./Stack-DXrRnMBT.js";import"./FolderCopy-CP57Ekr6.js";import"./getThemeProps-DrSwjl3y.js";import"./createSvgIcon-CLSAu-P9.js";import"./GlobalStyles-B6qBktMC.js";import"./listItemIconClasses-cx9A8stw.js";import"./useTheme-1MJ8xdPG.js";import"./ChevronRight-BAjMCg34.js";import"./PeopleAlt-Bz7uYnKM.js";import"./CalendarMonth-D3T3p82P.js";import"./ExitToApp-HVnRz0UA.js";import"./Toolbar-CFUzcVrf.js";import"./FormControl-DOOhO82m.js";import"./utils-BSJ2UkfV.js";import"./Select-D7VYoZyS.js";import"./colorManipulator-De43Jrm7.js";import"./Grow-Bq4CRTVA.js";import"./useThemeProps-CdhCwfGx.js";const me=({open:o,close:t})=>{const[s,{data:n,isLoading:l,isSuccess:r,error:i,reset:c}]=G(),[d,h]=a.useState(""),[S,b]=a.useState(""),p=x=>{x.preventDefault(),s({code:d,subject:S})};return a.useEffect(()=>{r&&(g.success(n.message),h(""),b(""),t(),c()),i&&(g.error(i.data.message),c())},[r,i,n]),e.jsx(T,{open:o,onClose:t,children:e.jsx(M,{in:o,children:e.jsx(j,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:l?e.jsx(k,{}):e.jsxs("form",{className:"form-subject",onSubmit:p,children:[e.jsx(w,{fullWidth:!0,label:"Code",placeholder:"Code",value:d,onChange:x=>h(x.target.value)}),e.jsx(w,{fullWidth:!0,label:"Subject",placeholder:"Subject",value:S,onChange:x=>b(x.target.value)}),e.jsxs(j,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(m,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"contained",color:"success",type:"submit",children:"add"})]})]})})})})},he=({open:o,close:t})=>{const[s,{data:n,isSuccess:l,error:r,reset:i,isLoading:c}]=$(),[d,h]=a.useState(null),S=p=>{h(p.target.files[0])},b=()=>{if(d){const p=new FileReader;p.onload=x=>{const f=new Uint8Array(x.target.result),C=re(f,{type:"array"}),E=C.SheetNames[0],L=C.Sheets[E],A={data:oe.sheet_to_json(L,{header:1,range:1})};s(A)},p.readAsArrayBuffer(d)}};return a.useEffect(()=>{l&&(g.success(n.message),h(null),i(),t()),r&&g.error(r.data.messege)},[n,l,r]),e.jsx(T,{open:o,onClose:t,closeAfterTransition:!0,children:e.jsx(M,{in:o,children:e.jsx(j,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs(j,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(R,{required:!0,fullWidth:!0,type:"file",placeholder:"Upload file here",onChange:S}),e.jsxs(j,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:1},children:[e.jsx(m,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"contained",color:"success",onClick:b,children:c?e.jsx(k,{size:18,color:"inherit"}):"update"})]})]})})})})},pe=({open:o,close:t})=>{const[s,{data:n,isLoading:l,isSuccess:r,error:i,reset:c}]=q(),d=()=>s();return a.useEffect(()=>{r&&(g.success(n.message),t(),c()),i&&(g.error(i.data.message),c())},[r,n,i]),e.jsx(T,{open:o,onClose:t,closeAfterTransition:!0,children:e.jsx(M,{in:o,children:e.jsxs(j,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:[e.jsx(ae,{align:"center",children:"Are you sure you want to delete all subjects?"}),e.jsxs(j,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:2},children:[e.jsx(m,{variant:"contained",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"outlined",color:"error",onClick:d,children:l?e.jsx(k,{size:15}):"sure"})]})]})})})},je=()=>{const[o,t]=a.useState(!1),[s,n]=a.useState(!1),[l,r]=a.useState(!1),i=()=>{open("/mapel_template.xlsx","_blank")};return e.jsxs(j,{sx:{display:"flex",justifyContent:{xs:"start",md:"end"},gap:1,flexWrap:"wrap"},children:[e.jsx(m,{variant:"contained",color:"success",startIcon:e.jsx(Z,{}),onClick:()=>n(!0),sx:{width:120},children:"Tambah"}),e.jsx(m,{startIcon:e.jsx(te,{}),variant:"contained",color:"secondary",onClick:()=>r(!0),sx:{width:120},children:"Unggah"}),e.jsx(m,{startIcon:e.jsx(se,{}),variant:"contained",color:"warning",onClick:i,sx:{width:120},children:"Template"}),e.jsx(m,{startIcon:e.jsx(ee,{}),variant:"contained",color:"error",onClick:()=>t(!0),sx:{width:120},children:"Hapus"}),e.jsx(me,{open:s,close:()=>n(!1)}),e.jsx(he,{open:l,close:()=>r(!1)}),e.jsx(pe,{open:o,close:()=>t(!1)})]})},be=({open:o,close:t,data:s,loading:n})=>{const[l,{data:r,isSuccess:i,isLoading:c,error:d}]=K(),[h,S]=a.useState(""),[b,p]=a.useState(""),x=f=>{f.preventDefault();const C={code:h,subject:b};l({id:s==null?void 0:s.id,body:C})};return a.useEffect(()=>{s&&(S(s==null?void 0:s.code),p(s==null?void 0:s.name))},[s]),a.useEffect(()=>{i&&g.success(r==null?void 0:r.message),d&&g.error(d.data.message)},[i,d,r]),e.jsx(T,{open:o,onClose:t,children:e.jsx(M,{in:o,children:e.jsx(j,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:n||c?e.jsx(I,{variant:"rounded",width:210,height:60}):e.jsxs("form",{className:"form-subject",onSubmit:x,children:[e.jsx(w,{fullWidth:!0,label:"Code",placeholder:"Code",value:h||"",onChange:f=>S(f.target.value)}),e.jsx(w,{fullWidth:!0,label:"Subject",placeholder:"Subject",value:b||"",onChange:f=>p(f.target.value)}),e.jsxs(j,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:2},children:[e.jsx(m,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(m,{variant:"contained",color:"success",type:"submit",children:"add"})]})]})})})})},ge=[{label:"No",minWidth:30},{label:"Kode",minWidth:50},{label:"Satuan",minWidth:50},{label:"Nama",minWidth:100},{label:"Aksi",minWidth:50}],Se=({subjects:o})=>{const[t,s]=a.useState(null),[n,l]=a.useState(null),r=!!t,i=(u,v)=>{s(u.currentTarget),l(v)},c=()=>{s(null),l(null)},[d,h]=a.useState(!1),[S,{data:b,isLoading:p,isSuccess:x,error:f}]=O(),[C,{data:E,isLoading:L}]=Q(),D=()=>{n&&(S(n),c())},A=()=>{n&&(C(n),h(!0),c())};a.useEffect(()=>{x&&g.success(b.message),f&&g.error(f.data.message)},[x,b,f]);const[F,N]=a.useState(""),P=u=>u.name.toLowerCase().includes(F.toLowerCase()),W=o==null?void 0:o.filter(P),U=u=>{N(u.target.value)};return e.jsxs(a.Fragment,{children:[e.jsxs(j,{sx:{p:1,mb:1,boxShadow:2,bgcolor:"white",borderRadius:1,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column-reverse",md:"row"},gap:2},children:[e.jsx(R,{placeholder:"Cari Mapel",value:F,onChange:U}),e.jsx(je,{})]}),e.jsx(ne,{sx:{width:"100%",overflowX:"auto"},children:e.jsx(ie,{sx:{height:{xs:500,md:532,xl:630},overflow:"auto"},children:e.jsxs(le,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(de,{children:e.jsx(H,{children:ge.map((u,v)=>e.jsx(y,{align:"center",sx:{width:u.minWidth},children:u.label},v))})}),e.jsx(ce,{children:W==null?void 0:W.map((u,v)=>e.jsxs(H,{children:[e.jsx(y,{align:"center",children:v+1}),e.jsx(y,{align:"center",children:u.code}),e.jsx(y,{align:"center",children:u.homebase}),e.jsx(y,{align:"left",children:u.name}),e.jsx(y,{align:"center",children:e.jsx(ue,{id:"basic-button","aria-controls":r?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":r?"true":void 0,onClick:z=>i(z,u.id),children:p?e.jsx(k,{size:24}):e.jsx(Y,{})})})]},v))})]})})}),e.jsxs(xe,{id:"basic-menu",anchorEl:t,open:r,onClose:c,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(_,{onClick:A,children:"Edit"}),e.jsx(_,{onClick:D,children:"Hapus"})]}),e.jsx(be,{open:d,close:()=>h(!1),data:E,loading:L})]})},it=()=>{const{data:o,isLoading:t}=X();return e.jsxs(J,{children:[e.jsx(V,{title:"Subjects"}),e.jsx(B,{container:!0,sx:{minHeight:"84vh",display:"flex",flexDirection:"column"},children:e.jsx(B,{item:!0,xs:12,md:12,children:t?e.jsxs(fe,{spacing:1,children:[e.jsx(I,{variant:"text",sx:{fontSize:"2rem"}}),e.jsx(I,{variant:"rounded",sx:{height:{xs:500,md:540,xl:640}}})]}):e.jsx(Se,{subjects:o})})})]})};export{it as default};
