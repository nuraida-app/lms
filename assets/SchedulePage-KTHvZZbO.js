import{o as re,L as ne,a0 as le,ab as ge,r as s,B as E,j as e,c as R,C as de,ac as Se,ad as be,ae as ve,af as Ce,ag as Te,a as we,a7 as ye,ah as De,ai as Ie}from"./index-DjgEXlBM.js";import{L as ke}from"./Layout-BRQ_XQ2b.js";import{P as ze}from"./PageName-ZPCS438x.js";import{d as x,L as U,A as O}from"./useMobilePicker-DIIgpCz5.js";import{u as ie,t as oe,D as K,a as V,S as Ee}from"./timezone-CFZ5YypE.js";import{M as Z,F as ee}from"./Modal-DCAalMQR.js";import{F as B}from"./FormControl-TopU_Zco.js";import{I as F,T as $}from"./TextField-CYEQKP_m.js";import{S as J,M as Ae}from"./Select-C4xHsIAt.js";import{M as m}from"./MenuItem-AkT7IuJC.js";import{B as Q}from"./Button-FzYR9QjW.js";import{d as Ge}from"./MoreHoriz-B7rLeTAL.js";import{d as qe,a as Pe}from"./FolderDelete---4wtr-M.js";import{P as te}from"./Paper-0_Nxrl9K.js";import{I as Me}from"./Input-Djdk2BZh.js";import{T as Qe}from"./TableContainer-ywpNEKl8.js";import{a as We,b as _e,c as ae,T as h}from"./TableRow-9p40iQCm.js";import{T as Ne}from"./TableBody-Dl-9RlEw.js";import{T as Y}from"./Typography-Ck8ZmvYm.js";import{I as He}from"./IconButton-DVAIich5.js";import{G as se}from"./Grid-Cm2mtght.js";import"./ChevronRight-JRIqjZRu.js";import"./createSvgIcon-DbdgCAn1.js";import"./PeopleAlt-DJyQ-vYi.js";import"./CalendarMonth-ZeFlFCc4.js";import"./Style-COl1V7Ra.js";import"./useTheme-BUXj7LXp.js";import"./ListItemText-sHcdjvhz.js";import"./GlobalStyles-naRZnfmu.js";import"./listItemIconClasses-8sYbMhEm.js";import"./InputAdornment-DK-9NlSR.js";import"./utils-CGVmn-r6.js";import"./Popper-ibqJkCiK.js";import"./Grow-C7cMHxnE.js";import"./useThemeProps-DFj2STIv.js";import"./SwitchBase-DhEz23A-.js";import"./Stack-BH-Q5u32.js";import"./KeyboardArrowRight-DMOeQY7W.js";x.extend(ie);x.extend(oe);const Le=({open:o,close:c})=>{const{data:d}=re(),{data:l}=ne(),{data:i}=le(),[u,{data:n,isSuccess:A,isLoading:G,error:p,reset:b}]=ge(),[j,v]=s.useState(""),[f,C]=s.useState(""),[q,g]=s.useState(""),[S,T]=s.useState(""),[P,w]=s.useState(""),[W,y]=s.useState(null),[_,D]=s.useState(null),I=i==null?void 0:i.filter(a=>a.teacher_id===j),M=a=>{const t=x(a).tz("Asia/Jakarta");y(t)},k=a=>{const t=x(a).tz("Asia/Jakarta");D(t)},N=a=>{a.preventDefault(),u({teacherId:j,gradeId:f,quizId:q,name:S,desc:P,start:W,end:_})},z=()=>{v(""),C(""),g(""),T(""),w(""),y(null),D(null),c()};return s.useEffect(()=>{A&&(E.success(n.message),c(),b(),v(""),C(""),g(""),T(""),w(""),y(null),D(null)),p&&(E.error(p.data.message),b())},[n,A,p]),e.jsx(Z,{open:o,onClose:z,children:e.jsx(ee,{in:o,children:e.jsx(R,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-schedule",onSubmit:N,children:[e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Teacher--"}),e.jsx(J,{value:j,onChange:a=>v(a.target.value),required:!0,label:"--Teacher--",children:d==null?void 0:d.map(a=>e.jsx(m,{value:a.id,children:a.name},a.id))})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Grade--"}),e.jsx(J,{value:f,onChange:a=>C(a.target.value),required:!0,label:"--Grade--",children:l==null?void 0:l.map(a=>e.jsx(m,{value:a.id,children:a.grade},a.id))})]}),j&&e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Quiz--"}),e.jsx(J,{value:q,onChange:a=>g(a.target.value),required:!0,label:"--Grade--",children:I==null?void 0:I.map(a=>e.jsx(m,{value:a.id,children:a.quiz_name},a.id))})]}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Schedule",value:S,onChange:a=>T(a.target.value)}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Description",value:P,onChange:a=>w(a.target.value)}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"Start",onChange:M})})}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"end",onChange:k})})}),e.jsxs(R,{sx:{display:"flex",justifyContent:"end",gap:1},children:[e.jsx(Q,{variant:"contained",color:"error",onClick:z,children:"cancel"}),e.jsx(Q,{variant:"contained",color:"success",type:"submit",children:G?e.jsx(de,{size:20,color:"inherit"}):"add"})]})]})})})})},Be=()=>{const[o,c]=s.useState(!1),[d,l]=s.useState(!1);return e.jsxs(R,{sx:{display:"flex",gap:1},children:[e.jsx(Q,{variant:"contained",color:"success",startIcon:e.jsx(qe,{}),onClick:()=>l(!0),sx:{width:120},children:"add"}),e.jsx(Q,{startIcon:e.jsx(Pe,{}),variant:"contained",color:"error",onClick:()=>c(!0),sx:{width:120},children:"Delete"}),e.jsx(Le,{open:d,close:()=>l(!1)})]})},Fe=({open:o,close:c,start:d,end:l})=>{const i=u=>{try{const n=new Date(u);return new Intl.DateTimeFormat("en-EN",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}).format(n)}catch{return console.error("Invalid date string:",u),"Invalid date"}};return e.jsx(Z,{open:o,onClose:c,closeAfterTransition:!0,children:e.jsx(ee,{in:o,children:e.jsxs(R,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{md:400,xl:600},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px",display:"flex",flexDirection:"column",gap:2},children:[d&&e.jsx($,{fullWidth:!0,label:"Mulai",value:i(d)}),l&&e.jsx($,{fullWidth:!0,label:"Selesai",value:i(l)}),e.jsx(Q,{variant:"contained",color:"error",onClick:c,children:"Tutup"})]})})})};x.extend(ie);x.extend(oe);const Je=({open:o,close:c,id:d})=>{const{data:l}=re(),{data:i}=ne(),{data:u}=le(),{data:n}=Se(d,{skip:!d}),[A,{data:G,isLoading:p,error:b,isSuccess:j,reset:v}]=be(),[f,C]=s.useState(""),[q,g]=s.useState(""),[S,T]=s.useState(""),[P,w]=s.useState(""),[W,y]=s.useState(""),[_,D]=s.useState(null),[I,M]=s.useState(null),k=u==null?void 0:u.filter(t=>t.teacher_id===f),N=t=>{const H=x(t).tz("Asia/Jakarta");D(H)},z=t=>{const H=x(t).tz("Asia/Jakarta");M(H)},a=t=>{t.preventDefault(),A({id:d,body:{teacherId:f,gradeId:q,quizId:S,name:P,desc:W,start:_,end:I}})};return s.useEffect(()=>{n&&(C(n.teacher_id),g(n.grade_id),T(n.quiz_id),w(n.schedule),y(n.description),D(x(n.start).tz("Asia/Jakarta")),M(x(n.end).tz("Asia/Jakarta")))},[n]),s.useEffect(()=>{j&&(E.success(G.message),c(),v()),b&&(E.error(b.data.message),v())},[G,j,b]),e.jsx(Z,{open:o,onClose:c,closeAfterTransition:!0,children:e.jsx(ee,{in:o,children:e.jsx(R,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-schedule",onSubmit:a,children:[e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Teacher--"}),e.jsx(J,{value:f,onChange:t=>C(t.target.value),required:!0,label:"--Teacher--",children:l==null?void 0:l.map(t=>e.jsx(m,{value:t.id,children:t.name},t.id))})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Grade--"}),e.jsx(J,{value:q,onChange:t=>g(t.target.value),required:!0,label:"--Grade--",children:i==null?void 0:i.map(t=>e.jsx(m,{value:t.id,children:t.grade},t.id))})]}),f&&e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Quiz--"}),e.jsx(J,{value:S,onChange:t=>T(t.target.value),required:!0,label:"--Grade--",children:k==null?void 0:k.map(t=>e.jsx(m,{value:t.id,children:t.quiz_name},t.id))})]}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Schedule",value:P,onChange:t=>w(t.target.value)}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Description",value:W,onChange:t=>y(t.target.value)}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"Start",value:_,onChange:N})})}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"End",value:I,onChange:z})})}),e.jsxs(R,{sx:{display:"flex",justifyContent:"end",gap:1},children:[e.jsx(Q,{variant:"contained",color:"error",onClick:c,children:"cancel"}),e.jsx(Q,{variant:"contained",color:"success",type:"submit",children:p?e.jsx(de,{size:20,color:"inherit"}):"update"})]})]})})})})},Re=[{label:"No",width:30},{label:"Teacher",width:120},{label:"Schedule",width:120},{label:"Quiz",width:120},{label:"Grade",width:30},{label:"Status",width:80},{label:"Note",width:30},{label:"Token",width:90},{label:"Actions",width:90}],$e=()=>{const{data:o}=ve(),[c,{data:d,isSuccess:l,error:i,reset:u}]=Ce(),[n,{data:A,isSuccess:G,error:p}]=Te(),b=we(),[j,v]=s.useState(""),[f,C]=s.useState(""),[q,g]=s.useState(!1),[S,T]=s.useState(""),[P,w]=s.useState(""),[W,y]=s.useState(""),[_,D]=s.useState(""),[I,M]=s.useState(!1),[k,N]=s.useState(null),z=!!k,a=(r,L,X,me,pe,je,fe)=>{N(r.currentTarget),v(L),C(X),T(me),w(pe),y(je),D(fe)},t=()=>{N(null)},H=r=>{c(r)},ce=()=>{t(),g(!0)},ue=()=>{M(!0),t()},he=()=>{S&&(t(),n(S))};s.useEffect(()=>{l&&(E.success(d.message),u()),i&&(E.error(i.data.message),u())},[d,l,i]),s.useEffect(()=>{G&&E.success(A.message),p&&E.error(p.data.message)},[A,G,p]);const xe=()=>{const r=P.replace(/\s+/g,"-");b(`/admin/schedules/${r}/${W}/${_}`)};return e.jsxs(s.Fragment,{children:[e.jsxs(te,{sx:{display:"flex",justifyContent:"space-between",p:1,mb:1},children:[e.jsx(Me,{placeholder:"Search Teacher"}),e.jsx(Be,{})]}),e.jsx(te,{children:e.jsx(Qe,{sx:{height:{xs:500,md:530,xl:630},overflow:"auto"},children:e.jsxs(We,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(_e,{children:e.jsx(ae,{children:Re.map((r,L)=>e.jsx(h,{align:"center",sx:{width:r.width},children:r.label},L))})}),e.jsx(Ne,{children:o==null?void 0:o.map((r,L)=>e.jsxs(ae,{children:[e.jsx(h,{align:"center",children:L+1}),e.jsx(h,{align:"left",children:r.teacher}),e.jsx(h,{align:"left",children:r.name}),e.jsx(h,{align:"left",children:r.quiz}),e.jsx(h,{align:"center",children:r.grade}),e.jsx(h,{align:"center",children:e.jsx(Ee,{checked:r.status,onChange:()=>H(r.id),color:"success",inputProps:{"aria-label":"controlled"}})}),e.jsx(h,{align:"center",children:new Date(r.start)>new Date?e.jsx(Y,{color:ye[600],children:"Upcoming"}):new Date(r.end)<new Date?e.jsx(Y,{color:De[600],children:"Finished"}):e.jsx(Y,{color:Ie[600],children:"Ongoing"})}),e.jsx(h,{align:"center",children:r.token}),e.jsx(h,{align:"center",children:e.jsx(He,{id:"basic-button","aria-controls":z?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":z?"true":void 0,onClick:X=>a(X,r.start,r.end,r.id,r.quiz,r.quiz_id,r.grade_id),children:e.jsx(Ge,{})})})]},L))})]})})}),e.jsx(Je,{open:I,close:()=>M(!1),id:S}),e.jsxs(Ae,{id:"basic-menu",anchorEl:k,open:z,onClose:t,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(m,{onClick:ce,children:"Schedule"}),e.jsx(m,{onClick:xe,children:"Detail"}),e.jsx(m,{onClick:ue,children:"Edit"}),e.jsx(m,{onClick:he,children:"Delete"})]}),e.jsx(Fe,{open:q,close:()=>g(!1),start:j,end:f})]})},At=()=>e.jsxs(ke,{children:[e.jsx(ze,{title:"Schedule"}),e.jsx(se,{container:!0,sx:{minHeight:"82vh",display:"flex",flexDirection:"column",gap:2},children:e.jsx(se,{item:!0,xs:12,md:12,children:e.jsx($e,{})})})]});export{At as default};
