import{h as Q,w as Y,r as a,B as v,j as e,c as g,C as A,x as J,y as V,f as Z,z as ee,g as se,A as ae,D as te}from"./index-zx9QfZoY.js";import{L as re}from"./Layout-CrlGJOeK.js";import{P as oe}from"./PageName-jjQDIWWV.js";import{d as ne}from"./MoreHoriz-B3w18AMM.js";import{d as le,a as ie}from"./FolderDelete-DByTlg9y.js";import{d as de,a as ce}from"./InsertDriveFileOutlined-BYAKvIue.js";import{M as B,F as R}from"./Modal-D9QrkZCY.js";import{T as H,I as _}from"./TextField-BJwxyke2.js";import{F as D}from"./FormControl-C4c9a5nH.js";import{S as F}from"./Select-SvZ_7dw1.js";import{M as N}from"./MenuItem-CRwodlBl.js";import{B as f}from"./Button-DXlUDVsQ.js";import{T as ue}from"./Typography-BbVuTYIM.js";import{r as xe,u as me}from"./xlsx-DT8pmw08.js";import{I as K}from"./Input-BOlgPoNw.js";import{d as he}from"./Check-DpL-E4xW.js";import{d as z}from"./Remove-Ckil8KOJ.js";import{S as pe}from"./Style-Z1RiwaPN.js";import{P as fe}from"./Paper-DOpa6jtL.js";import{T as je}from"./TableContainer-BZTGtx4W.js";import{T as ge,a as $,b as y,c as be}from"./TableRow-BN76dLse.js";import{T as Ce}from"./TableHead-D2TM6eWY.js";import{I as P}from"./IconButton-B86WcClk.js";import{M as ve}from"./Menu-CYSo7JTe.js";import{G as q}from"./Grid-BCizA4LM.js";import"./FolderCopy-C5Wgay4i.js";import"./getThemeProps-CgUQ_SlC.js";import"./createSvgIcon-ejoD_ev4.js";import"./GlobalStyles-CYc0cWWR.js";import"./listItemIconClasses-2n8eT5dP.js";import"./useTheme-D7Zdti-D.js";import"./ChevronRight-DD6-zMVG.js";import"./PeopleAlt-tYum5u-5.js";import"./CalendarMonth-DsKu-ARM.js";import"./ExitToApp-CQL913Gf.js";import"./Toolbar-BcTO8NSz.js";import"./utils-BeOBfU0K.js";import"./colorManipulator-DVYWUa-M.js";import"./Grow-HGwcTEBV.js";const we=({open:i,close:t})=>{const{data:s}=Q(),[o,{data:d,isLoading:u,isSuccess:c,error:x,reset:b}]=Y(),[h,w]=a.useState(""),[p,j]=a.useState(""),[T,m]=a.useState([]),C=n=>{n.preventDefault(),o({nip:h,name:p,subjectIds:T})};return a.useEffect(()=>{c&&(v.success(d.message),j(""),w(""),m([]),t(),b()),x&&v.error(x.data.message)},[c,d,x]),e.jsx(B,{open:i,onClose:t,closeAfterTransition:!0,children:e.jsx(R,{in:i,children:e.jsx(g,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-teacher",onSubmit:C,children:[e.jsx(H,{fullWidth:!0,type:"text",label:"NIP",placeholder:"NIP",value:h,onChange:n=>w(n.target.value),InputLabelProps:{shrink:!0}}),e.jsx(H,{fullWidth:!0,label:"Nama Lengkap",placeholder:"Full Name",value:p,onChange:n=>j(n.target.value),InputLabelProps:{shrink:!0}}),e.jsxs(D,{children:[e.jsx(_,{children:"--Mapel--"}),e.jsx(F,{required:!0,label:"--Mapel--",multiple:!0,value:T,onChange:n=>m(n.target.value),children:s==null?void 0:s.map((n,S)=>e.jsx(N,{value:n.code,children:n.name},S))})]}),e.jsxs(g,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",color:"error",onClick:t,children:"tutup"}),e.jsx(f,{variant:"contained",color:"success",type:"submit",children:u?e.jsx(A,{size:20,color:"inherit"}):"tambah"})]})]})})})})},Te=({open:i,close:t})=>{const[s,{data:o,isSuccess:d,isLoading:u,error:c}]=J(),x=()=>s();return a.useEffect(()=>{d&&(v.success(o.message),t()),c&&v.error(c.data.message)},[o,d,c]),e.jsx(B,{open:i,onClose:t,closeAfterTransition:!0,children:e.jsx(R,{in:i,children:e.jsxs(g,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:[e.jsx(ue,{align:"center",children:"Are you sure you want to delete all teachers?"}),e.jsxs(g,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:2},children:[e.jsx(f,{variant:"contained",color:"error",onClick:t,children:"cancel"}),e.jsx(f,{variant:"outlined",color:"error",onClick:x,children:u?e.jsx(A,{size:20,color:"inherit"}):"sure"})]})]})})})},ye=({open:i,close:t})=>{const[s,{data:o,isSuccess:d,error:u,isLoading:c}]=V(),[x,b]=a.useState(null),h=p=>{b(p.target.files[0])},w=()=>{if(x){const p=new FileReader;p.onload=j=>{const T=new Uint8Array(j.target.result),m=xe(T,{type:"array"}),C=m.SheetNames[0],n=m.Sheets[C],k={data:me.sheet_to_json(n,{header:1,range:1})};s(k)},p.readAsArrayBuffer(x)}};return a.useEffect(()=>{d&&(v.success(o.message),b(null),t(),window.location.reload()),u&&v.error(u.data.message)},[d,o,u]),e.jsx(B,{open:i,onClose:t,closeAfterTransition:!0,children:e.jsx(R,{in:i,children:e.jsx(g,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs(g,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:1},children:[e.jsx(K,{required:!0,fullWidth:!0,type:"file",placeholder:"Upload file here",onChange:h}),e.jsxs(g,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(f,{variant:"contained",color:"success",onClick:w,children:c?e.jsx(A,{size:20,color:"inherit"}):"upload"})]})]})})})})},Se=()=>{const[i,t]=a.useState(!1),[s,o]=a.useState(!1),[d,u]=a.useState(!1),c=()=>{open("/guru_template.xlsx","_blank")};return e.jsxs(g,{sx:{display:"flex",justifyContent:{xs:"start",md:"end"},gap:1,flexWrap:"wrap"},children:[e.jsx(f,{variant:"contained",color:"success",startIcon:e.jsx(le,{}),onClick:()=>o(!0),sx:{width:120},children:"tambah"}),e.jsx(f,{startIcon:e.jsx(de,{}),variant:"contained",color:"secondary",onClick:()=>u(!0),sx:{width:120},children:"Unggah"}),e.jsx(f,{startIcon:e.jsx(ce,{}),variant:"contained",color:"warning",onClick:c,sx:{width:120},children:"Template"}),e.jsx(f,{startIcon:e.jsx(ie,{}),variant:"contained",color:"error",onClick:()=>t(!0),sx:{width:120},children:"Hapus"}),e.jsx(we,{open:s,close:()=>o(!1)}),e.jsx(ye,{open:d,close:()=>u(!1)}),e.jsx(Te,{open:i,close:()=>t(!1)})]})},ke=({open:i,close:t,teacher:s})=>{const{data:o}=Q(),{data:d}=Z(),[u,{data:c,isSuccess:x,isLoading:b,error:h,reset:w}]=ee(),[p,j]=a.useState(""),[T,m]=a.useState(""),[C,n]=a.useState(2),[S,k]=a.useState(0),[E,L]=a.useState([]),G=r=>{r.preventDefault();const I={nip:p,name:T,homeroom:C,classCode:S,subjectIds:E};u({id:s==null?void 0:s.id,body:I})};return a.useEffect(()=>{x&&(v.success(c.message),j(""),m(""),n(""),k(""),L([]),t(),w()),h&&(v.error(h.data.message),w())},[c,x,h]),a.useEffect(()=>{s&&(j(s==null?void 0:s.nip),m(s==null?void 0:s.name),L(s==null?void 0:s.subject_code),n(s==null?void 0:s.homeroom),k(s==null?void 0:s.class_code))},[s]),e.jsx(B,{open:i,onClose:t,closeAfterTransition:!0,children:e.jsx(R,{in:i,children:e.jsx(g,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-teacher",onSubmit:G,children:[e.jsx(H,{fullWidth:!0,type:"text",label:"NIP",placeholder:"NIP",value:p||"",onChange:r=>j(r.target.value)}),e.jsx(H,{fullWidth:!0,label:"Nama Lengkap",placeholder:"Nama Lengkap",value:T||"",onChange:r=>m(r.target.value)}),e.jsxs(D,{children:[e.jsx(_,{children:"--Mapel--"}),e.jsx(F,{required:!0,label:"--Mapel--",multiple:!0,value:E||[],onChange:r=>L(r.target.value),children:o==null?void 0:o.map((r,I)=>e.jsx(N,{value:r.code,children:r.name},I))})]}),e.jsxs(D,{children:[e.jsx(_,{children:"--Homeroom--"}),e.jsxs(F,{label:"--Homeroom--",value:C,onChange:r=>n(r.target.value),children:[e.jsx(N,{value:1,children:"Yes"}),e.jsx(N,{value:2,children:"No"})]})]}),C===1&&e.jsxs(D,{children:[e.jsx(_,{children:"--Class--"}),e.jsx(F,{required:!0,label:"--Class--",value:S||"",onChange:r=>k(r.target.value),children:d==null?void 0:d.map(r=>e.jsx(N,{value:r.code,children:r.name},r.id))})]}),e.jsxs(g,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(f,{variant:"outlined",color:"error",onClick:t,children:"cancel"}),e.jsx(f,{variant:"contained",color:"success",type:"submit",children:b?e.jsx(A,{size:20,color:"inherit"}):"Edit"})]})]})})})})},Ie=[{label:"No",width:60},{label:"Satuan",width:90},{label:"NIP",width:90},{label:"Nama",width:170},{label:"Mapel",width:170},{label:"Wali Kelas",width:50},{label:"Kelas",width:50},{label:"Aksi",width:50}],Ne=()=>{const[i,t]=a.useState(null),s=!!i,[o,d]=a.useState(""),[u,c]=a.useState(!1),x=(l,M)=>{t(l.currentTarget),d(M)},b=()=>{t(null)},{data:h,isLoading:w}=se(),[p,{data:j,isLoading:T,error:m,isSuccess:C}]=ae(),[n,{data:S}]=te(),k=()=>{o&&(b(),c(!0),n(o))},E=()=>{o&&(p(o),b())};a.useEffect(()=>{C&&v.success(j.message),m&&v.error(m.data.message)},[C,j,m]);const[L,G]=a.useState(""),r=l=>l.name.toLowerCase().includes(L.toLowerCase()),I=h==null?void 0:h.filter(r),O=l=>{G(l.target.value)};return e.jsxs(a.Fragment,{children:[e.jsxs(g,{sx:{p:1,mb:1,boxShadow:2,bgcolor:"white",borderRadius:1,display:"flex",justifyContent:"space-between",flexDirection:{xs:"column-reverse",md:"row"},gap:2},children:[e.jsx(K,{placeholder:"Cari Guru",value:L,onChange:O}),e.jsx(Se,{})]}),w?e.jsx(pe,{variant:"rounded",height:530}):e.jsxs(fe,{sx:{width:"100%",overflowX:"auto"},children:[e.jsx(je,{sx:{height:{xs:500,md:530,xl:700},overflow:"auto"},children:e.jsxs(ge,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(Ce,{children:e.jsx($,{children:Ie.map((l,M)=>e.jsx(y,{align:"center",sx:{width:l.width},children:l.label},M))})}),e.jsx(be,{children:I==null?void 0:I.map((l,M)=>{var W;return e.jsxs($,{children:[e.jsx(y,{align:"center",children:M+1}),e.jsx(y,{align:"center",children:l.homebase_name}),e.jsx(y,{align:"center",children:l.nip}),e.jsx(y,{children:l.name}),e.jsx(y,{children:(W=l.subjects)==null?void 0:W.map((U,X)=>e.jsx("p",{children:U.subject},X))}),e.jsx(y,{align:"center",children:l.homeroom===1?e.jsx(P,{color:"success",children:e.jsx(he,{})}):e.jsx(P,{color:"error",children:e.jsx(z,{})})}),e.jsx(y,{align:"center",children:l.class?e.jsx("p",{children:l.class}):e.jsx(P,{color:"error",children:e.jsx(z,{})})}),e.jsx(y,{align:"center",children:e.jsx(P,{color:"primary",id:"basic-button","aria-controls":s?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":s?"true":void 0,onClick:U=>x(U,l.id),children:T?e.jsx(A,{size:20}):e.jsx(ne,{})})})]},M)})})]})}),e.jsxs(ve,{id:"basic-menu",anchorEl:i,open:s,onClose:b,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(N,{onClick:k,children:"Edit"}),e.jsx(N,{onClick:E,children:"Delete"})]})]}),e.jsx(ke,{open:u,close:()=>c(!1),teacher:S})]})},hs=()=>e.jsxs(re,{children:[e.jsx(oe,{title:"Teachers"}),e.jsx(q,{container:!0,sx:{minHeight:"85vh",display:"flex",flexDirection:"column",gap:2},children:e.jsx(q,{item:!0,xs:12,md:12,children:e.jsx(Ne,{})})})]});export{hs as default};
