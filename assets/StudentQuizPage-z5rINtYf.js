import{a as G,ar as Y,r as s,B as t,j as r,c as h,C as d,b as R,aq as K,as as O}from"./index-DjgEXlBM.js";import{L as W}from"./Layout-C4oyqOWG.js";import{P as J}from"./PageName-ZPCS438x.js";/* empty css               */import{C as U,a as V,b as X}from"./CardContent-DvRkyeoE.js";import{T as l}from"./Typography-Ck8ZmvYm.js";import{M as Z,F as ee}from"./Modal-DCAalMQR.js";import{I as F}from"./Input-Djdk2BZh.js";import{B as re}from"./Button-FzYR9QjW.js";import{P as se}from"./Paper-0_Nxrl9K.js";import"./ChevronRight-JRIqjZRu.js";import"./createSvgIcon-DbdgCAn1.js";import"./useTheme-BUXj7LXp.js";import"./IconButton-DVAIich5.js";import"./ListItemText-sHcdjvhz.js";import"./GlobalStyles-naRZnfmu.js";import"./listItemIconClasses-8sYbMhEm.js";import"./utils-CGVmn-r6.js";const C=e=>{try{const o=new Date(e);return new Intl.DateTimeFormat("en-EN",{weekday:"short",day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric"}).format(o)}catch{return console.error("Invalid date string:",e),"Invalid date"}},oe=({data:e,user:o,log:n})=>{const c=G(),[f,{data:a,isLoading:b,isSuccess:j,error:p,reset:g}]=Y(),[S,z]=s.useState(!1),[k,Q]=s.useState(!1),[w,y]=s.useState(""),[T,q]=s.useState(!1),[D,I]=s.useState(""),[v,E]=s.useState(""),[L,N]=s.useState(""),[u,P]=s.useState(""),A=(i,m,x,H,M,$)=>{z(!0),Q(i),q(m),I(x),E(H),N(M),P($)},B=i=>{if(i.preventDefault(),w!==k)return t.error("Token is mismatch");if(!T)return t.error("Quiz is inactive");const m=new Date;if(m<new Date(D))return t.error("Quiz have not started yet");if(m>new Date(v))return t.error("Quiz is finished");if(n&&n.isDone&&n.quiz_id===u)return t.error("You have already joined this exam");if(n&&n.isActive&&n.quiz_id===u)return t.error("You are joining this exam");const x={quizId:u,nis:o.nis};f(x)},_=()=>{z(!1),y("")};return s.useEffect(()=>{if(j){t.success(a.message);const i=L.replace(/\s+/g,"-");c(`/student/exam/${i}/${u}/${D}/${v}`),g(),localStorage.removeItem("questions")}p&&(t.error(p.data.message),g())},[j,a,p]),r.jsxs(s.Fragment,{children:[r.jsx(U,{sx:{width:260,bgcolor:new Date(e==null?void 0:e.start)>new Date?"#015AFF":new Date(e==null?void 0:e.end)<new Date?"#FF1414":"#37FF21",color:new Date(e==null?void 0:e.start)>new Date?"#F7F7F7":new Date(e==null?void 0:e.end)<new Date?"#0C0C0C":"#000000"},children:r.jsx(V,{onClick:()=>A(e==null?void 0:e.token,e==null?void 0:e.status,e==null?void 0:e.start,e==null?void 0:e.end,e==null?void 0:e.quiz,e==null?void 0:e.quiz_id),children:r.jsxs(X,{children:[r.jsx(l,{fontSize:16,children:e==null?void 0:e.quiz}),r.jsx(l,{fontSize:12,fontStyle:"italic",children:e==null?void 0:e.teacher}),r.jsxs(l,{fontSize:12,sx:{mt:1},children:["Start: ",C(e==null?void 0:e.start)]}),r.jsxs(l,{fontSize:12,children:["End: ",C(e==null?void 0:e.end)]})]})})}),r.jsx(Z,{open:S,onClose:_,closeAfterTransition:!0,children:r.jsx(ee,{in:S,children:r.jsx(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:r.jsxs("form",{onSubmit:B,className:"form-confirm",children:[r.jsx(F,{placeholder:"TOKEN",value:w,onChange:i=>y(i.target.value)}),r.jsx(re,{type:"submit",variant:"contained",color:"error",children:b?r.jsx(d,{size:20,color:"inherit"}):"submit"})]})})})})]})},De=()=>{const{user:e}=R(c=>c.authentication),{data:o}=K(e==null?void 0:e.grade_id,{skip:!(e!=null&&e.grade_id)}),{data:n}=O(e==null?void 0:e.nis,{skip:!(e!=null&&e.nis)});return r.jsxs(W,{children:[r.jsx(J,{title:"Quiz"}),r.jsxs(h,{sx:{height:"82vh",display:"flex",flexDirection:"column",gap:1},children:[r.jsx(se,{sx:{p:1},children:r.jsx(F,{placeholder:"Search Exam"})}),r.jsx(h,{sx:{display:"flex",flexWrap:"wrap",gap:1,maxHeight:520,overflow:"auto",alignItems:"start",overflowY:"auto"},children:o==null?void 0:o.map((c,f)=>r.jsx(oe,{data:c,user:e,log:n},f))})]})]})};export{De as default};
