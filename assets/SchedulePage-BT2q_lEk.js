import{g as re,G as ne,X as le,a7 as ge,r as s,B as z,j as e,c as U,C as ie,a8 as Se,a9 as be,aa as ve,ab as ke,ac as Ce,a as Te,a2 as Ie,ad as we,ae as ye}from"./index-DGvpjgWm.js";import{L as De}from"./Layout-kbi2dNGL.js";import{P as Ee}from"./PageName-FtGNY4ev.js";import{d as x,L as $,A as K}from"./useMobilePicker-DRiHsD8w.js";import{u as oe,t as de,D as O,a as X,S as ze}from"./timezone-DtQYLbxk.js";import{M as Z,F as ee}from"./Modal-DxRN-owh.js";import{F as Q}from"./FormControl-CbQkaRoK.js";import{I as F,T as R}from"./TextField-BGYf6AZQ.js";import{S as J}from"./Select-CQTrSYRN.js";import{M as m}from"./MenuItem-C60i-Lzy.js";import{B as L}from"./Button-D8VVO348.js";import{d as Ae}from"./MoreHoriz-Cf-2Etv1.js";import{d as Pe,a as Ge}from"./FolderDelete-CieqdwqK.js";import{P as te}from"./Paper-K36vHTxn.js";import{I as qe}from"./Input-Eg4Yuw_G.js";import{T as Me}from"./TableContainer-BgATlgLf.js";import{T as Le,a as ae,b as h,c as We}from"./TableRow-DhcfXF1c.js";import{T as _e}from"./TableHead-D4fHex_W.js";import{T as Y}from"./Typography-DriLene-.js";import{I as Be}from"./IconButton-pTgfu9-f.js";import{M as Ne}from"./Menu-CxNv4S-u.js";import{G as se}from"./Grid-BGwRTvts.js";import"./FolderCopy-fAMEYysm.js";import"./getThemeProps-DV--MwOD.js";import"./createSvgIcon-DOM3wMaB.js";import"./GlobalStyles-C1DXwv9-.js";import"./listItemIconClasses-hJOZkGUs.js";import"./useTheme-CPtJ_AT7.js";import"./ChevronRight-Bpz3WVJm.js";import"./PeopleAlt-DRk0_XzN.js";import"./CalendarMonth-gj1hcJ90.js";import"./Style-BhRVOdmN.js";import"./colorManipulator-BuMbTll3.js";import"./ExitToApp-Drr138pi.js";import"./Toolbar-BD1CLpQT.js";import"./InputAdornment-ClAcPR_e.js";import"./utils-CSmApv3b.js";import"./Popper-D89ibtHq.js";import"./Grow-CTPeHix_.js";import"./useThemeProps-BXFTq4Gc.js";import"./SwitchBase-DkuMWHuC.js";import"./Stack-DtPXufcT.js";import"./KeyboardArrowRight-BGexMzJj.js";x.extend(oe);x.extend(de);const He=({open:d,close:c})=>{const{data:i}=re(),{data:l}=ne(),{data:o}=le(),[u,{data:n,isSuccess:A,isLoading:P,error:p,reset:b}]=ge(),[j,v]=s.useState(""),[f,k]=s.useState(""),[G,g]=s.useState(""),[S,C]=s.useState(""),[q,T]=s.useState(""),[W,I]=s.useState(null),[_,w]=s.useState(null),y=o==null?void 0:o.filter(a=>a.teacher_id===j),M=a=>{const t=x(a).tz("Asia/Jakarta");I(t)},D=a=>{const t=x(a).tz("Asia/Jakarta");w(t)},B=a=>{a.preventDefault(),u({teacherId:j,gradeId:f,quizId:G,name:S,desc:q,start:W,end:_})},E=()=>{v(""),k(""),g(""),C(""),T(""),I(null),w(null),c()};return s.useEffect(()=>{A&&(z.success(n.message),c(),b(),v(""),k(""),g(""),C(""),T(""),I(null),w(null)),p&&(z.error(p.data.message),b())},[n,A,p]),e.jsx(Z,{open:d,onClose:E,children:e.jsx(ee,{in:d,children:e.jsx(U,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-schedule",onSubmit:B,children:[e.jsxs(Q,{fullWidth:!0,children:[e.jsx(F,{children:"--Guru--"}),e.jsx(J,{value:j,onChange:a=>v(a.target.value),required:!0,label:"--Guru--",children:i==null?void 0:i.map(a=>e.jsx(m,{value:a.id,children:a.name},a.id))})]}),e.jsxs(Q,{fullWidth:!0,children:[e.jsx(F,{children:"--Tingkat--"}),e.jsx(J,{value:f,onChange:a=>k(a.target.value),required:!0,label:"--Tingkat--",children:l==null?void 0:l.map(a=>e.jsx(m,{value:a.id,children:a.grade},a.id))})]}),j&&e.jsxs(Q,{fullWidth:!0,children:[e.jsx(F,{children:"--Bank Soal--"}),e.jsx(J,{value:G,onChange:a=>g(a.target.value),required:!0,label:"--Bank Soal--",children:y==null?void 0:y.map(a=>e.jsx(m,{value:a.id,children:a.quiz_name},a.id))})]}),e.jsx(R,{fullWidth:!0,required:!0,placeholder:"Nama Ujian",value:S,onChange:a=>C(a.target.value),InputLabelProps:{shrink:!0}}),e.jsx(R,{fullWidth:!0,required:!0,placeholder:"Keterangan",value:q,onChange:a=>T(a.target.value),InputLabelProps:{shrink:!0}}),e.jsx($,{dateAdapter:K,children:e.jsx(O,{components:["DateTimePicker"],children:e.jsx(X,{label:"Start",onChange:M})})}),e.jsx($,{dateAdapter:K,children:e.jsx(O,{components:["DateTimePicker"],children:e.jsx(X,{label:"end",onChange:D})})}),e.jsxs(U,{sx:{display:"flex",justifyContent:"end",gap:1},children:[e.jsx(L,{variant:"contained",color:"error",onClick:E,children:"tutup"}),e.jsx(L,{variant:"contained",color:"success",type:"submit",children:P?e.jsx(ie,{size:20,color:"inherit"}):"tambah"})]})]})})})})},Qe=()=>{const[d,c]=s.useState(!1),[i,l]=s.useState(!1);return e.jsxs(U,{sx:{display:"flex",gap:1},children:[e.jsx(L,{variant:"contained",color:"success",startIcon:e.jsx(Pe,{}),onClick:()=>l(!0),sx:{width:120},children:"Tambah"}),e.jsx(L,{startIcon:e.jsx(Ge,{}),variant:"contained",color:"error",onClick:()=>c(!0),sx:{width:120},children:"hapus"}),e.jsx(He,{open:i,close:()=>l(!1)})]})},Fe=({open:d,close:c,start:i,end:l})=>{const o=u=>{try{const n=new Date(u);return new Intl.DateTimeFormat("en-EN",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}).format(n)}catch{return console.error("Invalid date string:",u),"Invalid date"}};return e.jsx(Z,{open:d,onClose:c,closeAfterTransition:!0,children:e.jsx(ee,{in:d,children:e.jsxs(U,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{md:400,xl:600},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px",display:"flex",flexDirection:"column",gap:2},children:[i&&e.jsx(R,{fullWidth:!0,label:"Mulai",value:o(i)}),l&&e.jsx(R,{fullWidth:!0,label:"Selesai",value:o(l)}),e.jsx(L,{variant:"contained",color:"error",onClick:c,children:"Tutup"})]})})})};x.extend(oe);x.extend(de);const Je=({open:d,close:c,id:i})=>{const{data:l}=re(),{data:o}=ne(),{data:u}=le(),{data:n}=Se(i,{skip:!i}),[A,{data:P,isLoading:p,error:b,isSuccess:j,reset:v}]=be(),[f,k]=s.useState(""),[G,g]=s.useState(""),[S,C]=s.useState(""),[q,T]=s.useState(""),[W,I]=s.useState(""),[_,w]=s.useState(null),[y,M]=s.useState(null),D=u==null?void 0:u.filter(t=>t.teacher_id===f),B=t=>{const N=x(t).tz("Asia/Jakarta");w(N)},E=t=>{const N=x(t).tz("Asia/Jakarta");M(N)},a=t=>{t.preventDefault(),A({id:i,body:{teacherId:f,gradeId:G,quizId:S,name:q,desc:W,start:_,end:y}})};return s.useEffect(()=>{n&&(k(n.teacher_id),g(n.grade_id),C(n.quiz_id),T(n.schedule),I(n.description),w(x(n.start).tz("Asia/Jakarta")),M(x(n.end).tz("Asia/Jakarta")))},[n]),s.useEffect(()=>{j&&(z.success(P.message),c(),v()),b&&(z.error(b.data.message),v())},[P,j,b]),e.jsx(Z,{open:d,onClose:c,closeAfterTransition:!0,children:e.jsx(ee,{in:d,children:e.jsx(U,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-schedule",onSubmit:a,children:[e.jsxs(Q,{fullWidth:!0,children:[e.jsx(F,{children:"--Guru--"}),e.jsx(J,{value:f,onChange:t=>k(t.target.value),required:!0,label:"--Guru--",children:l==null?void 0:l.map(t=>e.jsx(m,{value:t.id,children:t.name},t.id))})]}),e.jsxs(Q,{fullWidth:!0,children:[e.jsx(F,{children:"--Tingkat--"}),e.jsx(J,{value:G,onChange:t=>g(t.target.value),required:!0,label:"--Tingkat--",children:o==null?void 0:o.map(t=>e.jsx(m,{value:t.id,children:t.grade},t.id))})]}),f&&e.jsxs(Q,{fullWidth:!0,children:[e.jsx(F,{children:"--Bank Soal--"}),e.jsx(J,{value:S,onChange:t=>C(t.target.value),required:!0,label:"--Bank Soal--",children:D==null?void 0:D.map(t=>e.jsx(m,{value:t.id,children:t.quiz_name},t.id))})]}),e.jsx(R,{fullWidth:!0,required:!0,placeholder:"Nama Ujian",value:q,onChange:t=>T(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(R,{fullWidth:!0,required:!0,placeholder:"Keterangan",value:W,onChange:t=>I(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx($,{dateAdapter:K,children:e.jsx(O,{components:["DateTimePicker"],children:e.jsx(X,{label:"Start",value:_,onChange:B})})}),e.jsx($,{dateAdapter:K,children:e.jsx(O,{components:["DateTimePicker"],children:e.jsx(X,{label:"End",value:y,onChange:E})})}),e.jsxs(U,{sx:{display:"flex",justifyContent:"end",gap:1},children:[e.jsx(L,{variant:"contained",color:"error",onClick:c,children:"tutup"}),e.jsx(L,{variant:"contained",color:"success",type:"submit",children:p?e.jsx(ie,{size:20,color:"inherit"}):"update"})]})]})})})})},Ue=[{label:"No",width:30},{label:"Guru",width:120},{label:"Ujian",width:120},{label:"bank Soal",width:120},{label:"Tingkat",width:30},{label:"Status",width:80},{label:"Ket",width:30},{label:"Token",width:90},{label:"Aksi",width:90}],Re=()=>{const{data:d}=ve(),[c,{data:i,isSuccess:l,error:o,reset:u}]=ke(),[n,{data:A,isSuccess:P,error:p}]=Ce(),b=Te(),[j,v]=s.useState(""),[f,k]=s.useState(""),[G,g]=s.useState(!1),[S,C]=s.useState(""),[q,T]=s.useState(""),[W,I]=s.useState(""),[_,w]=s.useState(""),[y,M]=s.useState(!1),[D,B]=s.useState(null),E=!!D,a=(r,H,V,me,pe,je,fe)=>{B(r.currentTarget),v(H),k(V),C(me),T(pe),I(je),w(fe)},t=()=>{B(null)},N=r=>{c(r)},ce=()=>{t(),g(!0)},ue=()=>{M(!0),t()},he=()=>{S&&(t(),n(S))};s.useEffect(()=>{l&&(z.success(i.message),u()),o&&(z.error(o.data.message),u())},[i,l,o]),s.useEffect(()=>{P&&z.success(A.message),p&&z.error(p.data.message)},[A,P,p]);const xe=()=>{const r=q.replace(/\s+/g,"-");b(`/admin/schedules/${r}/${W}/${_}`)};return e.jsxs(s.Fragment,{children:[e.jsxs(te,{sx:{display:"flex",justifyContent:"space-between",p:1,mb:1},children:[e.jsx(qe,{placeholder:"Search Teacher"}),e.jsx(Qe,{})]}),e.jsx(te,{children:e.jsx(Me,{sx:{height:{xs:500,md:530,xl:630},overflow:"auto"},children:e.jsxs(Le,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(_e,{children:e.jsx(ae,{children:Ue.map((r,H)=>e.jsx(h,{align:"center",sx:{width:r.width},children:r.label},H))})}),e.jsx(We,{children:d==null?void 0:d.map((r,H)=>e.jsxs(ae,{children:[e.jsx(h,{align:"center",children:H+1}),e.jsx(h,{align:"left",children:r.teacher}),e.jsx(h,{align:"left",children:r.name}),e.jsx(h,{align:"left",children:r.quiz}),e.jsx(h,{align:"center",children:r.grade}),e.jsx(h,{align:"center",children:e.jsx(ze,{checked:r.status,onChange:()=>N(r.id),color:"success",inputProps:{"aria-label":"controlled"}})}),e.jsx(h,{align:"center",children:new Date(r.start)>new Date?e.jsx(Y,{color:Ie[600],children:"Upcoming"}):new Date(r.end)<new Date?e.jsx(Y,{color:we[600],children:"Finished"}):e.jsx(Y,{color:ye[600],children:"Ongoing"})}),e.jsx(h,{align:"center",children:r.token}),e.jsx(h,{align:"center",children:e.jsx(Be,{id:"basic-button","aria-controls":E?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":E?"true":void 0,onClick:V=>a(V,r.start,r.end,r.id,r.quiz,r.quiz_id,r.grade_id),children:e.jsx(Ae,{})})})]},H))})]})})}),e.jsx(Je,{open:y,close:()=>M(!1),id:S}),e.jsxs(Ne,{id:"basic-menu",anchorEl:D,open:E,onClose:t,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(m,{onClick:ce,children:"Jadwal"}),e.jsx(m,{onClick:xe,children:"Detail"}),e.jsx(m,{onClick:ue,children:"Edit"}),e.jsx(m,{onClick:he,children:"Hapus"})]}),e.jsx(Fe,{open:G,close:()=>g(!1),start:j,end:f})]})},Lt=()=>e.jsxs(De,{children:[e.jsx(Ee,{title:"Schedule"}),e.jsx(se,{container:!0,sx:{minHeight:"82vh",display:"flex",flexDirection:"column",gap:2},children:e.jsx(se,{item:!0,xs:12,md:12,children:e.jsx(Re,{})})})]});export{Lt as default};
