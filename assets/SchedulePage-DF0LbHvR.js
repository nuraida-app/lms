import{g as re,G as ne,W as le,a6 as ge,r as s,B as E,j as e,c as R,C as de,a7 as Se,a8 as be,a9 as ve,aa as Ce,ab as Te,a as we,a1 as ye,ac as De,ad as Ie}from"./index-CBqzxWS9.js";import{L as ke}from"./Layout-BNgdQ4YH.js";import{P as ze}from"./PageName-C4sP66Ht.js";import{d as x,L as U,A as O}from"./useMobilePicker-7ldD1AQx.js";import{u as ie,t as oe,D as K,a as V,S as Ee}from"./timezone-DTeXdsMD.js";import{M as Z,F as ee}from"./Modal-CBB7Z81D.js";import{F as B}from"./FormControl-BLwwiMD9.js";import{I as F,T as $}from"./TextField-CP-9qv2v.js";import{S as J}from"./Select-BNmj1Ngj.js";import{M as m}from"./MenuItem-D_0O02Xm.js";import{B as Q}from"./Button-B_xu-GsZ.js";import{d as Ae}from"./MoreHoriz-CinNhB57.js";import{d as Ge,a as qe}from"./FolderDelete-i1tSkUUd.js";import{P as te}from"./Paper-CHCCFYqF.js";import{I as Pe}from"./Input-Lnaa8h_K.js";import{T as Me}from"./TableContainer-C623AcUq.js";import{T as Qe,a as ae,b as h,c as We}from"./TableRow-BlZIV6bx.js";import{T as _e}from"./TableHead-EOUloY0Q.js";import{T as Y}from"./Typography-CrWPuPVK.js";import{I as Ne}from"./IconButton-fUZ_sEew.js";import{M as He}from"./Menu-UxrHd9mF.js";import{G as se}from"./Grid--ggCq7Rv.js";import"./FolderCopy-DvBcCNgU.js";import"./getThemeProps-CbqsDNvq.js";import"./createSvgIcon-BY7hztag.js";import"./GlobalStyles-DyN9rhoG.js";import"./listItemIconClasses-CIQzwbog.js";import"./useTheme-Co8QHWII.js";import"./ChevronRight-BeZsILl3.js";import"./PeopleAlt-PNVEDtJp.js";import"./CalendarMonth-Ch2tT4zi.js";import"./Style-BZ9vKAjT.js";import"./ExitToApp-C0pvusEU.js";import"./Toolbar-CDjnfqYK.js";import"./InputAdornment-DlvXlLL3.js";import"./utils-DYWkOjGQ.js";import"./Popper-c7AMnxTw.js";import"./Grow-CSUfa3Iq.js";import"./useThemeProps-CpjuU6Ta.js";import"./SwitchBase-97VaYQLh.js";import"./Stack-Da2Xo9Pz.js";import"./KeyboardArrowRight-CUg_tHXh.js";x.extend(ie);x.extend(oe);const Le=({open:o,close:c})=>{const{data:d}=re(),{data:l}=ne(),{data:i}=le(),[u,{data:n,isSuccess:A,isLoading:G,error:p,reset:b}]=ge(),[j,v]=s.useState(""),[f,C]=s.useState(""),[q,g]=s.useState(""),[S,T]=s.useState(""),[P,w]=s.useState(""),[W,y]=s.useState(null),[_,D]=s.useState(null),I=i==null?void 0:i.filter(a=>a.teacher_id===j),M=a=>{const t=x(a).tz("Asia/Jakarta");y(t)},k=a=>{const t=x(a).tz("Asia/Jakarta");D(t)},N=a=>{a.preventDefault(),u({teacherId:j,gradeId:f,quizId:q,name:S,desc:P,start:W,end:_})},z=()=>{v(""),C(""),g(""),T(""),w(""),y(null),D(null),c()};return s.useEffect(()=>{A&&(E.success(n.message),c(),b(),v(""),C(""),g(""),T(""),w(""),y(null),D(null)),p&&(E.error(p.data.message),b())},[n,A,p]),e.jsx(Z,{open:o,onClose:z,children:e.jsx(ee,{in:o,children:e.jsx(R,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-schedule",onSubmit:N,children:[e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Teacher--"}),e.jsx(J,{value:j,onChange:a=>v(a.target.value),required:!0,label:"--Teacher--",children:d==null?void 0:d.map(a=>e.jsx(m,{value:a.id,children:a.name},a.id))})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Grade--"}),e.jsx(J,{value:f,onChange:a=>C(a.target.value),required:!0,label:"--Grade--",children:l==null?void 0:l.map(a=>e.jsx(m,{value:a.id,children:a.grade},a.id))})]}),j&&e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Quiz--"}),e.jsx(J,{value:q,onChange:a=>g(a.target.value),required:!0,label:"--Grade--",children:I==null?void 0:I.map(a=>e.jsx(m,{value:a.id,children:a.quiz_name},a.id))})]}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Schedule",value:S,onChange:a=>T(a.target.value)}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Description",value:P,onChange:a=>w(a.target.value)}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"Start",onChange:M})})}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"end",onChange:k})})}),e.jsxs(R,{sx:{display:"flex",justifyContent:"end",gap:1},children:[e.jsx(Q,{variant:"contained",color:"error",onClick:z,children:"cancel"}),e.jsx(Q,{variant:"contained",color:"success",type:"submit",children:G?e.jsx(de,{size:20,color:"inherit"}):"add"})]})]})})})})},Be=()=>{const[o,c]=s.useState(!1),[d,l]=s.useState(!1);return e.jsxs(R,{sx:{display:"flex",gap:1},children:[e.jsx(Q,{variant:"contained",color:"success",startIcon:e.jsx(Ge,{}),onClick:()=>l(!0),sx:{width:120},children:"add"}),e.jsx(Q,{startIcon:e.jsx(qe,{}),variant:"contained",color:"error",onClick:()=>c(!0),sx:{width:120},children:"Delete"}),e.jsx(Le,{open:d,close:()=>l(!1)})]})},Fe=({open:o,close:c,start:d,end:l})=>{const i=u=>{try{const n=new Date(u);return new Intl.DateTimeFormat("en-EN",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}).format(n)}catch{return console.error("Invalid date string:",u),"Invalid date"}};return e.jsx(Z,{open:o,onClose:c,closeAfterTransition:!0,children:e.jsx(ee,{in:o,children:e.jsxs(R,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{md:400,xl:600},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px",display:"flex",flexDirection:"column",gap:2},children:[d&&e.jsx($,{fullWidth:!0,label:"Mulai",value:i(d)}),l&&e.jsx($,{fullWidth:!0,label:"Selesai",value:i(l)}),e.jsx(Q,{variant:"contained",color:"error",onClick:c,children:"Tutup"})]})})})};x.extend(ie);x.extend(oe);const Je=({open:o,close:c,id:d})=>{const{data:l}=re(),{data:i}=ne(),{data:u}=le(),{data:n}=Se(d,{skip:!d}),[A,{data:G,isLoading:p,error:b,isSuccess:j,reset:v}]=be(),[f,C]=s.useState(""),[q,g]=s.useState(""),[S,T]=s.useState(""),[P,w]=s.useState(""),[W,y]=s.useState(""),[_,D]=s.useState(null),[I,M]=s.useState(null),k=u==null?void 0:u.filter(t=>t.teacher_id===f),N=t=>{const H=x(t).tz("Asia/Jakarta");D(H)},z=t=>{const H=x(t).tz("Asia/Jakarta");M(H)},a=t=>{t.preventDefault(),A({id:d,body:{teacherId:f,gradeId:q,quizId:S,name:P,desc:W,start:_,end:I}})};return s.useEffect(()=>{n&&(C(n.teacher_id),g(n.grade_id),T(n.quiz_id),w(n.schedule),y(n.description),D(x(n.start).tz("Asia/Jakarta")),M(x(n.end).tz("Asia/Jakarta")))},[n]),s.useEffect(()=>{j&&(E.success(G.message),c(),v()),b&&(E.error(b.data.message),v())},[G,j,b]),e.jsx(Z,{open:o,onClose:c,closeAfterTransition:!0,children:e.jsx(ee,{in:o,children:e.jsx(R,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:350,md:400},bgcolor:"#ffff",boxShadow:24,p:2,borderRadius:"5px"},children:e.jsxs("form",{className:"form-schedule",onSubmit:a,children:[e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Teacher--"}),e.jsx(J,{value:f,onChange:t=>C(t.target.value),required:!0,label:"--Teacher--",children:l==null?void 0:l.map(t=>e.jsx(m,{value:t.id,children:t.name},t.id))})]}),e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Grade--"}),e.jsx(J,{value:q,onChange:t=>g(t.target.value),required:!0,label:"--Grade--",children:i==null?void 0:i.map(t=>e.jsx(m,{value:t.id,children:t.grade},t.id))})]}),f&&e.jsxs(B,{fullWidth:!0,children:[e.jsx(F,{children:"--Quiz--"}),e.jsx(J,{value:S,onChange:t=>T(t.target.value),required:!0,label:"--Grade--",children:k==null?void 0:k.map(t=>e.jsx(m,{value:t.id,children:t.quiz_name},t.id))})]}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Schedule",value:P,onChange:t=>w(t.target.value)}),e.jsx($,{fullWidth:!0,required:!0,placeholder:"Description",value:W,onChange:t=>y(t.target.value)}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"Start",value:_,onChange:N})})}),e.jsx(U,{dateAdapter:O,children:e.jsx(K,{components:["DateTimePicker"],children:e.jsx(V,{label:"End",value:I,onChange:z})})}),e.jsxs(R,{sx:{display:"flex",justifyContent:"end",gap:1},children:[e.jsx(Q,{variant:"contained",color:"error",onClick:c,children:"cancel"}),e.jsx(Q,{variant:"contained",color:"success",type:"submit",children:p?e.jsx(de,{size:20,color:"inherit"}):"update"})]})]})})})})},Re=[{label:"No",width:30},{label:"Teacher",width:120},{label:"Schedule",width:120},{label:"Quiz",width:120},{label:"Grade",width:30},{label:"Status",width:80},{label:"Note",width:30},{label:"Token",width:90},{label:"Actions",width:90}],$e=()=>{const{data:o}=ve(),[c,{data:d,isSuccess:l,error:i,reset:u}]=Ce(),[n,{data:A,isSuccess:G,error:p}]=Te(),b=we(),[j,v]=s.useState(""),[f,C]=s.useState(""),[q,g]=s.useState(!1),[S,T]=s.useState(""),[P,w]=s.useState(""),[W,y]=s.useState(""),[_,D]=s.useState(""),[I,M]=s.useState(!1),[k,N]=s.useState(null),z=!!k,a=(r,L,X,me,pe,je,fe)=>{N(r.currentTarget),v(L),C(X),T(me),w(pe),y(je),D(fe)},t=()=>{N(null)},H=r=>{c(r)},ce=()=>{t(),g(!0)},ue=()=>{M(!0),t()},he=()=>{S&&(t(),n(S))};s.useEffect(()=>{l&&(E.success(d.message),u()),i&&(E.error(i.data.message),u())},[d,l,i]),s.useEffect(()=>{G&&E.success(A.message),p&&E.error(p.data.message)},[A,G,p]);const xe=()=>{const r=P.replace(/\s+/g,"-");b(`/admin/schedules/${r}/${W}/${_}`)};return e.jsxs(s.Fragment,{children:[e.jsxs(te,{sx:{display:"flex",justifyContent:"space-between",p:1,mb:1},children:[e.jsx(Pe,{placeholder:"Search Teacher"}),e.jsx(Be,{})]}),e.jsx(te,{children:e.jsx(Me,{sx:{height:{xs:500,md:530,xl:630},overflow:"auto"},children:e.jsxs(Qe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(_e,{children:e.jsx(ae,{children:Re.map((r,L)=>e.jsx(h,{align:"center",sx:{width:r.width},children:r.label},L))})}),e.jsx(We,{children:o==null?void 0:o.map((r,L)=>e.jsxs(ae,{children:[e.jsx(h,{align:"center",children:L+1}),e.jsx(h,{align:"left",children:r.teacher}),e.jsx(h,{align:"left",children:r.name}),e.jsx(h,{align:"left",children:r.quiz}),e.jsx(h,{align:"center",children:r.grade}),e.jsx(h,{align:"center",children:e.jsx(Ee,{checked:r.status,onChange:()=>H(r.id),color:"success",inputProps:{"aria-label":"controlled"}})}),e.jsx(h,{align:"center",children:new Date(r.start)>new Date?e.jsx(Y,{color:ye[600],children:"Upcoming"}):new Date(r.end)<new Date?e.jsx(Y,{color:De[600],children:"Finished"}):e.jsx(Y,{color:Ie[600],children:"Ongoing"})}),e.jsx(h,{align:"center",children:r.token}),e.jsx(h,{align:"center",children:e.jsx(Ne,{id:"basic-button","aria-controls":z?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":z?"true":void 0,onClick:X=>a(X,r.start,r.end,r.id,r.quiz,r.quiz_id,r.grade_id),children:e.jsx(Ae,{})})})]},L))})]})})}),e.jsx(Je,{open:I,close:()=>M(!1),id:S}),e.jsxs(He,{id:"basic-menu",anchorEl:k,open:z,onClose:t,MenuListProps:{"aria-labelledby":"basic-button"},children:[e.jsx(m,{onClick:ce,children:"Schedule"}),e.jsx(m,{onClick:xe,children:"Detail"}),e.jsx(m,{onClick:ue,children:"Edit"}),e.jsx(m,{onClick:he,children:"Delete"})]}),e.jsx(Fe,{open:q,close:()=>g(!1),start:j,end:f})]})},Mt=()=>e.jsxs(ke,{children:[e.jsx(ze,{title:"Schedule"}),e.jsx(se,{container:!0,sx:{minHeight:"82vh",display:"flex",flexDirection:"column",gap:2},children:e.jsx(se,{item:!0,xs:12,md:12,children:e.jsx($e,{})})})]});export{Mt as default};
