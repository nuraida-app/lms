import{r as c,aP as re,aQ as ne,aR as se,aS as ie,B as P,j as e,c as V,C as E,aT as le,aU as de,aV as oe,aW as he,aX as me,M as ce,aY as ue,aZ as _e}from"./index-CYXdUE1E.js";import{L as pe}from"./Layout-DddLk7dX.js";import{P as xe}from"./PageName-CxDLnQFs.js";import{d as b,L as B,A as R}from"./useMobilePicker-BpEOczoe.js";import{P as K}from"./Paper-AuHIivCD.js";import{G as W}from"./Grid-Dulq5jJu.js";import{T as l,I as H}from"./TextField-DAoeAYbq.js";import{D as G}from"./DatePicker-BmBdZFsc.js";import{F as Y}from"./FormControl-DOOhO82m.js";import{S as O}from"./Select-D7VYoZyS.js";import{M as N}from"./MenuItem-BD_El1ju.js";import{B as w}from"./Button-BStGdRtB.js";import{d as $}from"./Remove-zM8A-fg_.js";import{T as X}from"./TableContainer-COIuo7oA.js";import{T as Z,a as Q,b as T,c as ee}from"./TableRow-gTMiIF1c.js";import{T as ae}from"./TableHead-1WtMxtLe.js";import{I as te}from"./IconButton-Bi62Yzjz.js";import{B as ge}from"./ButtonGroup-BC3J3afz.js";import"./FolderCopy-CP57Ekr6.js";import"./getThemeProps-DrSwjl3y.js";import"./Typography-BE36mMcC.js";import"./createSvgIcon-CLSAu-P9.js";import"./Modal-Crt72BC3.js";import"./useTheme-1MJ8xdPG.js";import"./GlobalStyles-B6qBktMC.js";import"./listItemIconClasses-cx9A8stw.js";import"./ChevronRight-BAjMCg34.js";import"./Storage-ChC2KShk.js";import"./CalendarMonth-D3T3p82P.js";import"./Style-Dt-mDLA7.js";import"./colorManipulator-De43Jrm7.js";import"./ExitToApp-HVnRz0UA.js";import"./Toolbar-CFUzcVrf.js";import"./InputAdornment-bj1M0JCG.js";import"./utils-BSJ2UkfV.js";import"./Popper-DjzC07dN.js";import"./Grow-Bq4CRTVA.js";import"./useThemeProps-CdhCwfGx.js";import"./Input-DTyQuvE5.js";import"./Menu-iVf4hf8j.js";const fe=({provinces:a,info:r,name:g,nis:p})=>{const[v,_]=c.useState(""),[f,n]=c.useState(""),[j,h]=c.useState(""),[L,{data:C,isSuccess:y,error:D,isLoading:o,reset:i}]=re(),{data:x}=ne(v,{skip:!v}),{data:k}=se(f,{skip:!f}),{data:F}=ie(j,{skip:!j}),[s,d]=c.useState({name:g,nisn:"",nis:p,birth_place:"",birth_date:b(),height:0,weight:0,around_head:0,order_birth:0,siblings:1,province_id:"",province_name:"",regency_id:"",regency_name:"",district_id:"",district_name:"",village_id:"",village_name:"",district:"",address:"",postal_code:""}),t=m=>{const{name:S,value:z}=m.target;if(S==="province_id"){const I=a==null?void 0:a.find(M=>M.id===z);_(z),d({...s,province_id:z,province_name:I?I.name:""})}if(S==="regency_id"){const I=x==null?void 0:x.find(M=>M.id===z);n(z),d({...s,regency_id:z,regency_name:I?I.name:""})}if(S==="district_id"){const I=k==null?void 0:k.find(M=>M.id===z);h(z),d({...s,district_id:z,district_name:I?I.name:""})}if(S==="village_id"){const I=F==null?void 0:F.find(M=>M.id.trim()===z.trim());d({...s,village_id:z,village_name:I?I.name:""})}S!=="province_id"&&S!=="regency_id"&&S!=="district_id"&&S!=="village_id"&&d({...s,[S]:z})},u=m=>{const S=b(m).startOf("day");d({...s,birth_date:S.toISOString()})},A=m=>{m.preventDefault();const S={...s,birth_date:b(s.birth_date).format("YYYY-MM-DD")};console.log(S),L(S)};return c.useEffect(()=>{y&&(P.success(C.message),i()),D&&(P.error(D.data.message),i())},[y,D,C]),c.useEffect(()=>{r&&(d({name:r.name,nisn:r.nisn,nis:r.nis,birth_place:r.birth_place,birth_date:r.birth_date?b(r.birth_date):b(),height:r.height,weight:r.weight,around_head:r.around_head,order_birth:r.order_birth,siblings:r.siblings,province_id:r.province_id,province_name:r.province_name,regency_id:r.regency_id,regency_name:r.regency_name,district_id:r.district_id,district_name:r.district_name,village_id:r.village_id.trim(),village_name:r.village_name,address:r.address,postal_code:r.postal_code}),_(r.province_id),n(r.regency_id),h(r.district_id))},[r]),e.jsx(K,{sx:{width:"100%",p:1},children:e.jsxs("form",{onSubmit:A,children:[e.jsxs(W,{container:!0,children:[e.jsxs(W,{item:!0,xs:12,md:6,sx:{p:1,display:"flex",flexDirection:"column",gap:2},children:[e.jsx(l,{fullWidth:!0,label:"Nama Lengkap",size:"small",variant:"standard",name:"name",value:s.name||"",onChange:t}),e.jsx(l,{fullWidth:!0,label:"NISN",size:"small",variant:"standard",name:"nisn",value:s.nisn||"",onChange:t}),e.jsx(l,{fullWidth:!0,label:"NIS",size:"small",variant:"standard",name:"nis",value:s.nis||"",onChange:t}),e.jsx(l,{fullWidth:!0,label:"Tempat Lahir",size:"small",variant:"standard",name:"birth_place",value:s.birth_place||"",onChange:t}),e.jsx(B,{dateAdapter:R,children:e.jsx(G,{label:"Tanggal Lahir",value:s.birth_date||"",onChange:u,slotProps:{textField:{fullWidth:!0,variant:"standard"}}})}),e.jsx(l,{fullWidth:!0,type:"number",label:"Anak Ke",size:"small",variant:"standard",name:"order_birth",value:s.order_birth||0,onChange:t}),e.jsx(l,{fullWidth:!0,type:"number",label:"Jml Saudara Kandung",size:"small",variant:"standard",name:"siblings",value:s.siblings||1,onChange:t}),e.jsx(l,{fullWidth:!0,type:"number",label:"Tinggi",size:"small",variant:"standard",name:"height",value:s.height||0,onChange:t}),e.jsx(l,{fullWidth:!0,type:"number",label:"Berat",size:"small",variant:"standard",name:"weight",value:s.weight||0,onChange:t})]}),e.jsxs(W,{item:!0,xs:12,md:6,sx:{p:1,display:"flex",flexDirection:"column",gap:2},children:[e.jsx(l,{fullWidth:!0,type:"number",label:"Lingkar Kepala",size:"small",variant:"standard",name:"around_head",value:s.around_head||0,onChange:t}),e.jsxs(Y,{fullWidth:!0,variant:"standard",children:[e.jsx(H,{children:"--Provinsi--"}),e.jsx(O,{name:"province_id",value:s.province_id||"",onChange:t,children:a==null?void 0:a.map(m=>e.jsx(N,{value:m.id,children:m.name},m.id))})]}),v&&e.jsxs(Y,{fullWidth:!0,variant:"standard",children:[e.jsx(H,{children:"--Kota / Kabupaten--"}),e.jsx(O,{name:"regency_id",value:s.regency_id||"",onChange:t,children:x==null?void 0:x.map(m=>e.jsx(N,{value:m.id,children:m.name},m.id))})]}),f&&e.jsxs(Y,{fullWidth:!0,variant:"standard",children:[e.jsx(H,{children:"--Kecamatan--"}),e.jsx(O,{name:"district_id",value:s.district_id||"",onChange:t,children:k==null?void 0:k.map(m=>e.jsx(N,{value:m.id,children:m.name},m.id))})]}),j&&e.jsxs(Y,{fullWidth:!0,variant:"standard",children:[e.jsx(H,{children:"--Desa--"}),e.jsx(O,{name:"village_id",value:s.village_id||"",onChange:t,children:F==null?void 0:F.map(m=>e.jsx(N,{value:m.id.trim(),children:m.name},m.id.trim()))})]}),e.jsx(l,{fullWidth:!0,label:"Alamat",size:"small",variant:"standard",name:"address",value:s.address||"",onChange:t}),e.jsx(l,{fullWidth:!0,label:"Kode Pos",size:"small",variant:"standard",name:"postal_code",value:s.postal_code||"",onChange:t})]})]}),e.jsx(V,{sx:{display:"flex",justifyContent:"end"},children:e.jsx(w,{variant:"contained",color:"success",type:"submit",children:o?e.jsx(E,{size:24,color:"inherit"}):"simpan"})})]})})};function je(a){const r=new Date,g=new Date(a);let p=r.getFullYear()-g.getFullYear();const v=r.getMonth()-g.getMonth();return(v<0||v===0&&r.getDate()<g.getDate())&&p--,p}const be=({info:a})=>{const[r,{isSuccess:g,data:p,isLoading:v,error:_,reset:f}]=le(),[n,{isSuccess:j,data:h,isLoading:L,error:C,reset:y}]=de(),[D,o]=c.useState((a==null?void 0:a.family_info)||[]),[i,x]=c.useState({family_name:"",family_gender:"",family_birth_date:b()}),k=t=>{const{name:u,value:A}=t.target;x({...i,[u]:A})},F=t=>{const u=b(t).startOf("day");x({...i,family_birth_date:u.toISOString()})},s=()=>{const t={family_name:i.family_name,family_gender:i.family_gender,family_birth_date:i.family_birth_date,id:Date.now()},u={nis:a.nis,familyData:[...D,t]};r(u).unwrap().then(()=>{o(A=>[...A,t]),x({family_name:"",family_gender:"",family_birth_date:b()})})},d=t=>{const u={nis:a.nis,familyId:t};n(u).unwrap().then(()=>{o(D.filter(A=>A.id!==t))})};return c.useEffect(()=>{g&&(P.success(p.message),f()),_&&(P.error(_.data.message),f())},[g,_,f,p]),c.useEffect(()=>{j&&(P.success(h.message),y()),C&&(P.error(C.data.message),y())},[j,C,h]),e.jsx(K,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2,p:1},children:e.jsxs(W,{container:!0,children:[e.jsx(W,{item:!0,xs:12,md:8,sx:{p:1},children:e.jsx(X,{component:K,sx:{maxHeight:{xs:500,md:450,lg:530},overflow:"auto"},children:e.jsxs(Z,{children:[e.jsx(ae,{children:e.jsx(Q,{children:["No","Nama","Kelamin","Tanggal Lahir","Usia","Aksi"].map(t=>e.jsx(T,{children:t},t))})}),e.jsx(ee,{children:D.map((t,u)=>e.jsxs(Q,{children:[e.jsx(T,{children:u+1}),e.jsx(T,{children:t.family_name}),e.jsx(T,{children:t.family_gender}),e.jsx(T,{children:b(t.family_birth_date).format("DD/MM/YYYY")}),e.jsx(T,{children:je(t.family_birth_date)}),e.jsx(T,{children:e.jsx(te,{color:"error",onClick:()=>d(t.id),children:L?e.jsx(E,{size:20,color:"inherit"}):e.jsx($,{})})})]},t.id))})]})})}),e.jsx(W,{item:!0,xs:12,md:4,sx:{p:1},children:e.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"1rem"},onSubmit:t=>{t.preventDefault(),s()},children:[e.jsx(l,{fullWidth:!0,size:"small",variant:"standard",label:"Nama",name:"family_name",value:i.family_name,onChange:k,required:!0}),e.jsxs(Y,{required:!0,children:[e.jsx(H,{children:"-Kelamin--"}),e.jsxs(O,{label:"--Kelamin--",name:"family_gender",value:i.family_gender,onChange:k,children:[e.jsx(N,{value:"Male",children:"Pria"}),e.jsx(N,{value:"Female",children:"Wanita"})]})]}),e.jsx(B,{dateAdapter:R,children:e.jsx(G,{label:"Tanggal Lahir",name:"family_birth_date",value:i.family_birth_date,onChange:F,slotProps:{textField:{fullWidth:!0,variant:"standard"}}})}),e.jsx(w,{fullWidth:!0,variant:"contained",color:"success",type:"submit",children:v?e.jsx(E,{size:20,color:"inherit"}):"simpan"})]})})]})})},q=a=>a!=null&&a.startsWith("0")?`62${a.slice(1)}`:a,J=a=>{const r=a.replace(/[^\d]/g,"");return`Rp ${parseInt(r,10).toLocaleString("id-ID")}`},U=a=>a.replace(/[^\d]/g,""),ve=({info:a})=>{const[r,{data:g,isSuccess:p,isLoading:v,error:_,reset:f}]=oe(),[n,j]=c.useState({father_nik:"",father_name:"",father_birth_place:"",father_birth_date:b(),father_job:"",father_position:"",father_earning:0,father_phone:"",mother_nik:"",mother_name:"",mother_birth_place:"",mother_birth_date:b(),mother_job:"",mother_position:"",mother_earning:0,mother_phone:"",nis:""}),h=o=>{const{name:i,value:x}=o.target;j({...n,[i]:i==="father_phone"||i==="mother_phone"?q(x):x})},L=o=>{const{name:i,value:x}=o.target;j({...n,[i]:J(x)})},C=o=>{const i=b(o).startOf("day");j({...n,father_birth_date:i.toISOString()})},y=o=>{const i=b(o).startOf("day");j({...n,mother_birth_date:i.toISOString()})},D=o=>{o.preventDefault();const i={...n,father_earning:U(n.father_earning),mother_earning:U(n.mother_earning)};r(i)};return c.useEffect(()=>{p&&(P.success(g.message),f()),_&&(P.error(_.data.message),f())},[p,_,g]),c.useEffect(()=>{a&&j({father_nik:a.father_nik,father_name:a.father_name,father_birth_place:a.father_birth_place,father_birth_date:a.father_birth_date?b(a.father_birth_date):b(),father_job:a.father_job,father_position:a.father_position,father_earning:a.father_earning?J(a.father_earning):0,father_phone:q(a.father_phone),mother_nik:a.mother_nik,mother_name:a.mother_name,mother_birth_place:a.mother_birth_place,mother_birth_date:a.mother_birth_date?b(a.mother_birth_date):b(),mother_job:a.mother_job,mother_position:a.mother_position,mother_earning:a.mother_earning?J(a.mother_earning):0,mother_phone:q(a.mother_phone),nis:a.nis})},[a]),e.jsx(K,{sx:{width:"100%",p:1},children:e.jsxs("form",{onSubmit:D,children:[e.jsxs(W,{container:!0,children:[e.jsxs(W,{item:!0,xs:12,md:6,sx:{display:"flex",flexDirection:"column",gap:2,p:1},children:[e.jsx(l,{fullWidth:!0,type:"number",label:"NIK Ayah",size:"small",variant:"standard",name:"father_nik",value:n.father_nik||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Nama Ayah",size:"small",variant:"standard",name:"father_name",value:n.father_name||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Tempat Lahir",size:"small",variant:"standard",name:"father_birth_place",value:n.father_birth_place||"",onChange:h}),e.jsx(B,{dateAdapter:R,children:e.jsx(G,{label:"Tanggal Lahir",value:n.father_birth_date,onChange:C,slotProps:{textField:{fullWidth:!0,variant:"standard"}}})}),e.jsx(l,{fullWidth:!0,label:"Pekerjaan",size:"small",variant:"standard",name:"father_job",value:n.father_job||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Jabatan",size:"small",variant:"standard",name:"father_position",value:n.father_position||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Penghasilan",size:"small",variant:"standard",name:"father_earning",onChange:L,value:n.father_earning||""}),e.jsx(l,{fullWidth:!0,type:"number",label:"Tlp",size:"small",variant:"standard",name:"father_phone",onChange:h,value:n.father_phone||""})]}),e.jsxs(W,{item:!0,xs:12,md:6,sx:{display:"flex",flexDirection:"column",gap:2,p:1},children:[e.jsx(l,{fullWidth:!0,type:"number",label:"NIK Ibu",size:"small",variant:"standard",name:"mother_nik",value:n.mother_nik||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Nama Ibu",size:"small",variant:"standard",name:"mother_name",value:n.mother_name||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Tempat Lahir",size:"small",variant:"standard",name:"mother_birth_place",value:n.mother_birth_place||"",onChange:h}),e.jsx(B,{dateAdapter:R,children:e.jsx(G,{label:"Tanggal Lahir",value:n.mother_birth_date,onChange:y,slotProps:{textField:{fullWidth:!0,variant:"standard"}}})}),e.jsx(l,{fullWidth:!0,label:"Pekerjaan",size:"small",variant:"standard",name:"mother_job",value:n.mother_job||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Jabatan",size:"small",variant:"standard",name:"mother_position",value:n.mother_position||"",onChange:h}),e.jsx(l,{fullWidth:!0,label:"Penghasilan",size:"small",variant:"standard",name:"mother_earning",onChange:L,value:n.mother_earning||""}),e.jsx(l,{fullWidth:!0,type:"number",label:"Tlp",size:"small",variant:"standard",name:"mother_phone",onChange:h,value:n.mother_phone||""})]})]}),e.jsx(V,{sx:{display:"flex",justifyContent:"end"},children:e.jsx(w,{variant:"contained",color:"success",type:"submit",children:v?e.jsx(E,{size:20,color:"inherit"}):"simpan"})})]})})},ye=({info:a})=>{const[r,{data:g,isLoading:p,isSuccess:v,error:_,reset:f}]=he(),[n,{isSuccess:j,data:h,isLoading:L,error:C,reset:y}]=me(),[D,o]=c.useState((a==null?void 0:a.health_records)||[]),[i,x]=c.useState({health_notes:""}),k=d=>{const{name:t,value:u}=d.target;x({...i,[t]:u})},F=()=>{const d={...i,id:Date.now()};o(u=>[...u,d]);const t={nis:a==null?void 0:a.nis,healthData:[...D,d].map(u=>({...u,id:u.id}))};r(t),x({health_notes:""})},s=d=>{const t={nis:a==null?void 0:a.nis,healthId:d};n(t).unwrap().then(()=>{o(D.filter(u=>u.id!==d))})};return c.useEffect(()=>{v&&(P.success(g.message),f()),_&&(P.error(_.data.message),f())},[g,v,_,f]),c.useEffect(()=>{j&&(P.success(h.message),y()),C&&(P.error(C.data.message),y())},[j,C,h]),e.jsx(K,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2,p:1},children:e.jsxs(W,{container:!0,children:[e.jsx(W,{item:!0,xs:12,md:8,sx:{p:1},children:e.jsx(X,{component:K,sx:{maxHeight:{xs:500,md:450,lg:530},overflow:"auto"},children:e.jsxs(Z,{children:[e.jsx(ae,{children:e.jsx(Q,{children:["No","Catatan","Aksi"].map(d=>e.jsx(T,{children:d},d))})}),e.jsx(ee,{children:D.map((d,t)=>e.jsxs(Q,{children:[e.jsx(T,{children:t+1}),e.jsx(T,{children:d.health_notes}),e.jsx(T,{children:e.jsx(te,{color:"error",onClick:()=>s(d.id),children:p?e.jsx(E,{size:20,color:"inherit"}):e.jsx($,{})})})]},d.id))})]})})}),e.jsx(W,{item:!0,xs:12,md:4,sx:{p:1},children:e.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"1rem"},onSubmit:d=>{d.preventDefault(),F()},children:[e.jsx(l,{fullWidth:!0,required:!0,size:"small",variant:"standard",label:"Catatan Kesehatan",name:"health_notes",value:i.health_notes,onChange:k}),e.jsx(w,{fullWidth:!0,variant:"contained",color:"success",type:"submit",children:p?e.jsx(E,{size:20,color:"inherit"}):"simpan"})]})})]})})},oa=()=>{const[a,r]=c.useState(!0),[g,p]=c.useState(!1),[v,_]=c.useState(!1),[f,n]=c.useState(!1),j=()=>{r(!0),p(!1),_(!1),n(!1)},h=()=>{r(!1),p(!0),_(!1),n(!1)},L=()=>{r(!1),p(!1),_(!0),n(!1)},C=()=>{r(!1),p(!1),_(!1),n(!0)},y=ce(),{data:D}=ue(),{data:o}=_e(y.nis,{skip:!y.nis});return e.jsxs(pe,{children:[e.jsx(xe,{title:"Database"}),e.jsx(W,{container:!0,sx:{minHeight:"85vh",display:"flex",flexDirection:"column"},children:e.jsxs(V,{sx:{display:"flex",flexDirection:"column",gap:2,justifyContent:"center",alignItems:"center"},children:[e.jsx(K,{children:e.jsxs(ge,{children:[e.jsx(w,{onClick:j,variant:a?"contained":"outlined",color:"primary",children:"Data Diri"}),o&&e.jsx(w,{onClick:h,variant:g?"contained":"outlined",color:"primary",children:"Orang Tua"}),o&&e.jsx(w,{onClick:L,variant:v?"contained":"outlined",color:"primary",children:"Keluarga"}),o&&e.jsx(w,{onClick:C,variant:f?"contained":"outlined",color:"primary",children:"Kesehatan"})]})}),a&&e.jsx(fe,{provinces:D,info:o,name:y.studentName.replace(/-/g," "),nis:y.nis}),g&&e.jsx(ve,{info:o}),v&&e.jsx(be,{info:o}),f&&e.jsx(ye,{info:o})]})})]})};export{oa as default};
